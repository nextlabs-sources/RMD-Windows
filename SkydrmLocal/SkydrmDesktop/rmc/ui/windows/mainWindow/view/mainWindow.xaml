<local:CustomMainWindow x:Class="SkydrmLocal.rmc.ui.windows.mainWindow.view.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:i="http://schemas.microsoft.com/expression/2010/interactivity"
        xmlns:local="clr-namespace:SkydrmLocal.rmc.ui.windows.mainWindow"
        xmlns:local_convert="clr-namespace:SkydrmLocal.rmc.ui.windows.mainWindow.helper.converter"
        xmlns:local_event="clr-namespace:SkydrmLocal.rmc.ui.windows.mainWindow.helper"
        xmlns:local_custom="clr-namespace:SkydrmLocal.rmc.ui.components"
        xmlns:ext="clr-namespace:SkydrmLocal.rmc.ui.components.sortListView"
        xmlns:list_view="clr-namespace:SkydrmLocal.rmc.ui.components.ListViewLayoutManagerLib"
        xmlns:Tree_View="clr-namespace:SkydrmLocal.rmc.ui.windows.mainWindow.treeViewComponent.view"
        xmlns:p="clr-namespace:SkydrmDesktop.Properties"
        mc:Ignorable="d"
                        
        Height="{Binding Source={x:Static p:Settings.Default}, Path=Height, Mode=TwoWay}"
        Width="{Binding Source={x:Static p:Settings.Default}, Path=Width, Mode=TwoWay}"
        Left="{Binding Source={x:Static p:Settings.Default}, Path=Left, Mode=TwoWay}"
        Top="{Binding Source={x:Static p:Settings.Default}, Path=Top, Mode=TwoWay}"
        MinWidth="1000" MinHeight="600" 
        FontFamily="/nxrmdapp;component/resources/font/#Lato"
        AllowDrop="True" Drop="Window_Drop"
        StateChanged="Window_StateChanged"
        BorderBrush="White"
        WindowStartupLocation="CenterScreen" Icon="/nxrmdapp;component/AppICON.ico" Title="SkyDRM DESKTOP"
        >

    <!--Resource-->
    <Window.Resources>
        <local_convert:ListFileStatus2IconConverter x:Key="fstatusIconConvert"/>
        <local_convert:ListFile2IconConverterEx x:Key="fileIconConvert"/>
        <local_convert:SharedWithConverter x:Key="swc"/>
        <local_convert:SharedWithOrByConverter x:Key="swObc"/>
        <local_convert:SharedWithMoreConverter x:Key="swmc"/>
        <local_convert:Count2BoolConverter x:Key="c2bc"/>
        <local_convert:FileStatusEnum2Bool x:Key="fse2b"/>
        <local_convert:ListCount2BoolConverter x:Key="lc2b"/>
        <local_convert:NetworkStatusBool2StringInfo x:Key="nsb2s"/>
        <local_convert:NetworkStatusBool2ImageConverter x:Key="nsb2i"/>
        <local_convert:NetStatusBool2LineStatus x:Key="nsb2ls"/>
        <local_convert:NetStatusBool2LineColor x:Key="nsb2lc"/>
        <local_convert:ReadableFileSizeConverter x:Key="rfsc"/>
        <local_convert:ButtonUploadContentConverter x:Key="btnUploadContentConver"/>
        <local_convert:ButtonUploadTagConverter x:Key="btnUploadTagConver"/>
        <local_convert:ButtonUploadCommandParameterConverter x:Key="btnUploadCommandConver"/>
        <local_convert:MenuitemStartUploadStatusConverter x:Key="MenuitemStartUploadConver"/>
        <local_convert:MenuitemStopUploadStatusConverter x:Key="MenuitemStopUploadConver"/>
        <local_convert:MenuitemSelectFileStatusConverter x:Key="MenuitemSelectFileStatusConver"/>
        <local_convert:MenuitemRemoveFileStatusConverter x:Key="MenuitemRemoveFileStatusConver"/>
        <local_convert:ItemCountsConverter x:Key="ItemConver"/>
        <local_convert:DisplayVisibilityConverter x:Key="VisibilityConver"/>
        <local_convert:DisplayGridWidthConverter x:Key="WidthConver"/>
        <local_convert:DisplayContentNotDataConverter x:Key="ContentNotDataConver"/>
        <local_convert:UpdatingIconVisibilityConverter x:Key="UpdatingIconConver"/>
        <local_convert:EditedAndModifiedStausConverter x:Key="EditedAndModifiedStatusConver"/>
        <local_convert:EditedAndModifiedTextConverter x:Key="EditedAndModifiedTextConver"/>
        <local_convert:ListViewVisibilityConverter x:Key="ListViewVisibilityConver"/>
        <local_convert:FilterListViewVisibilityConverter x:Key="FilterListVisibilityConver"/>
        <local_convert:TabItemSharedWithHeaderConverter x:Key="TabItemSharedWithHeaderConver"/>
        <local_convert:TabItemSharedByHeaderConverter x:Key="TabItemSharedByHeaderConver"/>
        <local_convert:TabItemSharedWithVisibilityConverter x:Key="TabItemSharedWithVisibilityConver"/>
        <local_convert:TabItemSharedByVisibilityConverter x:Key="TabItemSharedByVisibilityConver"/>
        <local_convert:IsProtectBtnEnableConverter x:Key="ProtectBtnIsEnableConver"/>
        <local_convert:IsShareBtnEnableConverter x:Key="ShareBtnIsEnableConver"/>
        <local_convert:ProtectBtnTagConverter x:Key="ProtectBtnTagConver"/>
        <local_convert:ShareBtnTagConverter x:Key="ShareBtnTagConver"/>
        <local_convert:AddNxlBtnTagConverter x:Key="AddNxlBtnTagConver"/>
        <local_convert:IsDisplayDateColumnContentConverter x:Key="IsDisplayDateColConver"/>
        <local_convert:IsDisplayShareColumnContentConverter x:Key="IsDisplayShareColConver"/>
        <local_convert:IsDisplaySharedFromColuContentConverter x:Key="IsDisplaySharedFromColConver"/>
        <local_convert:SearchPromptTextVisibilityConverter x:Key="SearchPromptVisibilityConver"/>
        <local_convert:DisplayLoadingPageConverter x:Key="LoadingPageConver"/>
        <local_convert:TimestampToDateTimeConverter x:Key="TimestampToDateTime"/>
        <local_convert:NetworkStatusBool2VisibilityInfo x:Key="NeteWork2VisibilityConver"/>
        <local_convert:RepoInfoVisibility x:Key="RepoInfoVisibleConvert"/>
        <local_convert:RepoInfoExternalRepoTypeIconVisibility x:Key="RepoInfoExternalRepoTypeIconVisible"/>
        <local_convert:RepoDescribeInfoVisibility x:Key="RepoDescribeVisibleConvert"/>
        <local_convert:CreateFolderVisibility x:Key="CreateFolderVisibleConvert"/>
        <local_convert:UploadFileVisibility x:Key="UploadFileVisibleConvert"/>
        <local_convert:ProjectMemberVisibility x:Key="ProjectMemberVisibleConvert"/>
        <local_convert:HomeVisibility x:Key="HomeVisibleConvert"/>
        <local_convert:HomeWorkSpaceVisibility x:Key="HomeWorkSpaceVisibleConvert"/>
        <local_convert:HomeRepositoryVisibility x:Key="HomeRepositoryVisibleConvert"/>
        <local_convert:MySpaceVisibility x:Key="MySpaceVisibleConvert"/>
        <local_convert:RepositoriesUIVisibility x:Key="RepositoriesVisibleConvert"/>
        <local_convert:RepositoriesConfigTextVisibility x:Key="RepositoriesConfigTextVisible"/>
        <local_convert:RepositoriesIconConverter x:Key="RepositoriesIconConvert"/>
        <local_convert:RepositoriesTypeIconConverter x:Key="RepositoriesTypeIconConvert"/>
        <local_convert:RepositoriesTypeColorConverter x:Key="RepositoriesTypeColorConvert"/>
        <local_convert:DisplayProjectLixBoxConverter x:Key="DisplayProjectLixBoxConver"/>
        <local_convert:ProjectLixBoxGroupNameConverter x:Key="ProjectGroupNameConver"/>
        <local_convert:ProjectLixBoxGroupName2Converter x:Key="ProjectGroupName2Conver"/>
        <local_convert:EmptyFolderVisibilityConverter x:Key="EmptyFolderVisibilityConver"/>
        <local_convert:ProjectPageListNameConverter x:Key="ProjectPageListNameConver"/>
        <local_convert:EmptyImageVisibilityConverter x:Key="EmptyImageVisibilityConver"/>
        <local_convert:EmptyFolderTextConverter x:Key="EmptyFolderTextConver"/>
        <local_convert:SearchComboxVisibilityConverter x:Key="SearchComboxVisibilityConver"/>
        <local_convert:FileLocationConentConverter x:Key="FileLocationConentConverter"/>
        <local_convert:MenuitemFileStatusNetworkMultiBindConverter x:Key="MenuitemFileStatusNetworkMultiBindConverter"/>
        <local_convert:MenuitemFileInfoStatusNetworkMultiBindConverter x:Key="MenuItemFileInfoIsEnableCovert"/>
        <!--for file downloading, upload failed, edited attach extra control converter-->
        <local_convert:SpecialFileStatus2SpVisibileConverter x:Key="SpecialStatusSpVisbileConver"/>
        <local_convert:SpecialFileStatus2ImageConverter x:Key="SpecialStatusImageConver"/>
        <local_convert:SpecialFileStatus2TextConverter x:Key="SpecialStatusTextConver"/>
        <local_convert:FilterListSourcePathConverter x:Key="FilterListSourcePathConver"/>
        <local_convert:ConverseBoolConverter x:Key="ConverseBoolConverter"/>
        


        <!--Data template for "Name" field-->
        <DataTemplate x:Key="nameTemplateEx">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="20"></ColumnDefinition>
                    <ColumnDefinition Width="AUTO"></ColumnDefinition>
                    <ColumnDefinition Width="*"></ColumnDefinition>
                </Grid.ColumnDefinitions>

                <Image Grid.Column="0" Width="20" Height="20">
                    <Image.Source>
                        <MultiBinding Converter="{StaticResource fstatusIconConvert}">
                            <Binding Path="FileStatus"/>
                            <Binding Path="IsMarkedOffline"/>
                        </MultiBinding>
                    </Image.Source>
                </Image>

                <Image Margin="0,2,0,2" Grid.Column="1" Width="30" Height="30">
                    <Image.Source>
                        <MultiBinding Converter="{StaticResource fileIconConvert}">
                            <Binding Path="Name" />
                            <Binding Path="IsFolder" />
                            <Binding Path="IsMarkedOffline" />
                            <Binding Path="IsNxlFile" />
                        </MultiBinding>
                    </Image.Source>
                </Image>

                <Image Grid.Column="1" Width="20" Height="20" Stretch="None" Visibility="{Binding Path=FileStatus,Converter={StaticResource UpdatingIconConver}}" Source="/rmc/resources/icons/icon_downloading.png">
                    <Image.RenderTransform>
                        <TranslateTransform X="15" Y="11"></TranslateTransform>
                    </Image.RenderTransform>
                </Image>

                <DockPanel LastChildFill="True" Grid.Column="2">
                    <StackPanel DockPanel.Dock="Bottom" Orientation="Horizontal" VerticalAlignment="Center" Margin="10,2,0,0">
                        <StackPanel.Visibility>
                            <MultiBinding Converter="{StaticResource SpecialStatusSpVisbileConver}">
                                <Binding Path="FileStatus"/>
                                <Binding Path="IsMarkedOffline"/>
                                <Binding Path="IsEdit"/>
                            </MultiBinding>
                        </StackPanel.Visibility>

                        <Image Width="13" Height="13" Stretch="Fill" Margin="0,0,5,0">
                            <Image.Source>
                                <MultiBinding Converter="{StaticResource SpecialStatusImageConver}">
                                    <Binding Path="FileStatus"/>
                                    <Binding Path="IsMarkedOffline"/>
                                    <Binding Path="IsEdit"/>
                                </MultiBinding>
                            </Image.Source>
                        </Image>
                        <TextBlock Foreground="Gray" FontSize="11" VerticalAlignment="Center" HorizontalAlignment="Left">
                            <TextBlock.Text>
                                <MultiBinding Converter="{StaticResource SpecialStatusTextConver}">
                                    <Binding Path="FileStatus"/>
                                    <Binding Path="IsMarkedOffline"/>
                                    <Binding Path="IsEdit"/>
                                </MultiBinding>
                            </TextBlock.Text>
                        </TextBlock>
                    </StackPanel>

                    <TextBlock DockPanel.Dock="Top" Text="{Binding Path=Name}"  TextTrimming="CharacterEllipsis" VerticalAlignment="Center" Margin="10,0,0,0"/>
                </DockPanel>
            </Grid>
        </DataTemplate>

        <!--For FilterList Data template for "Name" field-->
        <DataTemplate x:Key="FilternameTemplateEx">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="20"></ColumnDefinition>
                    <ColumnDefinition Width="AUTO"></ColumnDefinition>
                    <ColumnDefinition Width="*"></ColumnDefinition>
                </Grid.ColumnDefinitions>

                <Image Grid.Column="0" Width="20" Height="20">
                    <Image.Source>
                        <MultiBinding Converter="{StaticResource fstatusIconConvert}">
                            <Binding Path="FileStatus"/>
                            <Binding Path="IsMarkedOffline"/>
                        </MultiBinding>
                    </Image.Source>
                </Image>

                <Image Margin="0,2,0,2" Grid.Column="1" Width="30" Height="30">
                    <Image.Source>
                        <MultiBinding Converter="{StaticResource fileIconConvert}">
                            <Binding Path="Name" />
                            <Binding Path="IsFolder" />
                            <Binding Path="IsMarkedOffline" />
                            <Binding Path="IsNxlFile" />
                        </MultiBinding>
                    </Image.Source>
                </Image>

                <Image Grid.Column="1" Width="20" Height="20" Stretch="None" Visibility="Collapsed" Source="/rmc/resources/icons/icon_downloading.png">
                    <Image.RenderTransform>
                        <TranslateTransform X="13" Y="11"></TranslateTransform>
                    </Image.RenderTransform>
                </Image>

                <DockPanel LastChildFill="True" Grid.Column="2">

                    <TextBlock DockPanel.Dock="Bottom" Text="{Binding SourcePath}" TextTrimming="CharacterEllipsis" VerticalAlignment="Center" Margin="10,2,0,0" 
                               FontSize="11"  Foreground="Gray" Visibility="{Binding Path=Visibility, ElementName=sp_attach, Converter={StaticResource FilterListSourcePathConver}}"></TextBlock>

                    <StackPanel x:Name="sp_attach" DockPanel.Dock="Bottom" Orientation="Horizontal" VerticalAlignment="Center" Margin="10,2,0,0">
                        <StackPanel.Visibility>
                            <MultiBinding Converter="{StaticResource SpecialStatusSpVisbileConver}">
                                <Binding Path="FileStatus"/>
                                <Binding Path="IsMarkedOffline"/>
                                <Binding Path="IsEdit"/>
                            </MultiBinding>
                        </StackPanel.Visibility>

                        <Image Width="13" Height="13" Stretch="Fill" Margin="0,0,5,0">
                            <Image.Source>
                                <MultiBinding Converter="{StaticResource SpecialStatusImageConver}">
                                    <Binding Path="FileStatus"/>
                                    <Binding Path="IsMarkedOffline"/>
                                    <Binding Path="IsEdit"/>
                                </MultiBinding>
                            </Image.Source>
                        </Image>
                        <TextBlock Foreground="Gray" FontSize="11" VerticalAlignment="Center" HorizontalAlignment="Left">
                            <TextBlock.Text>
                                <MultiBinding Converter="{StaticResource SpecialStatusTextConver}">
                                    <Binding Path="FileStatus"/>
                                    <Binding Path="IsMarkedOffline"/>
                                    <Binding Path="IsEdit"/>
                                </MultiBinding>
                            </TextBlock.Text>
                        </TextBlock>
                    </StackPanel>
                    <TextBlock DockPanel.Dock="Top" Text="{Binding Path=Name}"  TextTrimming="CharacterEllipsis" VerticalAlignment="Center" Margin="10,0,0,0"/>
                </DockPanel>
            </Grid>
        </DataTemplate>

        <!--For SharedByList Data template for "Name" field-->
        <DataTemplate x:Key="SharedByListNameTemplateEx">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="20"></ColumnDefinition>
                    <ColumnDefinition Width="AUTO"></ColumnDefinition>
                    <ColumnDefinition Width="*"></ColumnDefinition>
                </Grid.ColumnDefinitions>

                <Image Grid.Column="0" Width="20" Height="20">
                    <Image.Source>
                        <MultiBinding Converter="{StaticResource fstatusIconConvert}">
                            <Binding Path="FileStatus"/>
                            <Binding Path="IsMarkedOffline"/>
                        </MultiBinding>
                    </Image.Source>
                </Image>

                <Image Margin="0,2,0,2" Grid.Column="1" Width="30" Height="30">
                    <Image.Source>
                        <MultiBinding Converter="{StaticResource fileIconConvert}">
                            <Binding Path="Name" />
                            <Binding Path="IsFolder" />
                            <Binding Path="IsMarkedOffline" />
                            <Binding Path="IsNxlFile" />
                        </MultiBinding>
                    </Image.Source>
                </Image>

                <DockPanel LastChildFill="True" Grid.Column="2">
                    <!--only myvault file can display original path, should add property in INxlFile interface, can't binding 'RmsRemotePath'-->
                    <!--<TextBlock DockPanel.Dock="Bottom" Margin="10,2,0,0" VerticalAlignment="Center"  
                               FontSize="11"  Foreground="Gray" TextTrimming="CharacterEllipsis" 
                               Text="{Binding RmsRemotePath}"
                               ToolTip="{DynamicResource MainWin__ListView_OriginalPath}"
                               Visibility="{Binding Path=Visibility, ElementName=sp_attach, Converter={StaticResource FilterListSourcePathConver}}"/>-->

                    <StackPanel x:Name="sp_attach" DockPanel.Dock="Bottom" Orientation="Horizontal" VerticalAlignment="Center" Margin="10,2,0,0">
                        <StackPanel.Visibility>
                            <MultiBinding Converter="{StaticResource SpecialStatusSpVisbileConver}">
                                <Binding Path="FileStatus"/>
                                <Binding Path="IsMarkedOffline"/>
                                <Binding Path="IsEdit"/>
                            </MultiBinding>
                        </StackPanel.Visibility>

                        <Image Width="13" Height="13" Stretch="Fill" Margin="0,0,5,0">
                            <Image.Source>
                                <MultiBinding Converter="{StaticResource SpecialStatusImageConver}">
                                    <Binding Path="FileStatus"/>
                                    <Binding Path="IsMarkedOffline"/>
                                    <Binding Path="IsEdit"/>
                                </MultiBinding>
                            </Image.Source>
                        </Image>
                        <TextBlock Foreground="Gray" FontSize="11" VerticalAlignment="Center" HorizontalAlignment="Left">
                            <TextBlock.Text>
                                <MultiBinding Converter="{StaticResource SpecialStatusTextConver}">
                                    <Binding Path="FileStatus"/>
                                    <Binding Path="IsMarkedOffline"/>
                                    <Binding Path="IsEdit"/>
                                </MultiBinding>
                            </TextBlock.Text>
                        </TextBlock>
                    </StackPanel>
                    <TextBlock DockPanel.Dock="Top" Text="{Binding Path=Name}"  TextTrimming="CharacterEllipsis" VerticalAlignment="Center" Margin="10,0,0,0"/>
                </DockPanel>
            </Grid>
        </DataTemplate>

        <!--Shared with List sharedBy column DataTemplate-->
        <DataTemplate x:Key="sharedByTemplate">
            <TextBlock HorizontalAlignment="Left" TextTrimming="CharacterEllipsis" Text="{Binding SharedBy}" ToolTip="{Binding SharedBy}"/>
        </DataTemplate>

        <!--Data tempate for "SharedWith" field in Filter list-->
        <DataTemplate x:Key="sharedWithTemplate">
            <TextBlock x:Name="tb_shared" HorizontalAlignment="Left" TextTrimming="CharacterEllipsis">
                <TextBlock.Text>
                    <MultiBinding Converter="{StaticResource swc}">
                        <Binding Path="FileRepo" />
                        <Binding Path="SharedWith" />
                    </MultiBinding>
                </TextBlock.Text>
                <TextBlock.ToolTip>
                    <MultiBinding Converter="{StaticResource swc}">
                        <Binding Path="FileRepo" />
                        <Binding Path="SharedWith" />
                    </MultiBinding>
                </TextBlock.ToolTip>
            </TextBlock>
        </DataTemplate>

        <!--Data tempate for "SharedWith" or "SharedBy" field-->
        <DataTemplate x:Key="sharedWithOrByTemplate">
            <TextBlock x:Name="tb_shared" HorizontalAlignment="Left" TextTrimming="CharacterEllipsis">
                <TextBlock.Text>
                    <MultiBinding Converter="{StaticResource swObc}">
                        <Binding Path="FileRepo" />
                        <Binding Path="SharedWith" />
                        <Binding Path="SharedBy" />
                    </MultiBinding>
                </TextBlock.Text>
                <TextBlock.ToolTip>
                    <MultiBinding Converter="{StaticResource swObc}">
                        <Binding Path="FileRepo" />
                        <Binding Path="SharedWith" />
                        <Binding Path="SharedBy" />
                    </MultiBinding>
                </TextBlock.ToolTip>
            </TextBlock>
            <!--<StackPanel VerticalAlignment="Center" HorizontalAlignment="Stretch" Orientation="Horizontal">
                Shared with
                <TextBlock x:Name="tb_shared" HorizontalAlignment="Left" TextTrimming="CharacterEllipsis">
                    <TextBlock.Text>
                        <MultiBinding Converter="{StaticResource swc}">
                            <Binding Path="FileRepo" />
                            <Binding Path="SharedWith" />
                        </MultiBinding>
                    </TextBlock.Text>
                    <TextBlock.ToolTip>
                        <MultiBinding Converter="{StaticResource swc}">
                            <Binding Path="FileRepo" />
                            <Binding Path="SharedWith" />
                        </MultiBinding>
                    </TextBlock.ToolTip>
                </TextBlock>
                More
                <TextBlock x:Name="tb_more" Text="{Binding Path=SharedWith, Converter={StaticResource swmc}}"
                          Padding="3" Foreground="White" FontSize="10" HorizontalAlignment="Right" Margin="0,0,5,0"
                          Visibility="Collapsed">
                    <TextBlock.Background>
                        <ImageBrush Stretch="Uniform" ImageSource="/rmc/resources/icons/Icon_Ellipse.png"  />
                    </TextBlock.Background>
                </TextBlock>
            </StackPanel>-->

            <!--Data Trigger-->
            <!--<DataTemplate.Triggers>
                <DataTrigger Binding="{Binding ElementName=tb_shared, Path=Text,
                    Converter={StaticResource c2bc}}" Value="true">
                    <Setter TargetName="tb_more" Property="Visibility" Value="Visible"/>
                </DataTrigger>
            </DataTemplate.Triggers>-->
        </DataTemplate>

        <!--For ProjectPageList Data template for "Name" field-->
        <DataTemplate x:Key="ProjectPageNameTemplate">
            <Grid Height="30">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="AUTO"></ColumnDefinition>
                    <ColumnDefinition Width="*"></ColumnDefinition>
                </Grid.ColumnDefinitions>

                <Image Grid.Column="0" Stretch="None" Source="{Binding ProjectInfo.BOwner,Converter={StaticResource ProjectPageListNameConver}}"></Image>

                <TextBlock Grid.Column="1" Text="{Binding Path=ProjectInfo.Name}"  TextTrimming="CharacterEllipsis" VerticalAlignment="Center" Margin="10,0,0,0"/>

            </Grid>

        </DataTemplate>

        <!--For ProjectPageList Data template for "Project Description" field-->
        <DataTemplate x:Key="ProjectPageDescriptionTemplate">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"></ColumnDefinition>
                </Grid.ColumnDefinitions>
                <TextBlock Grid.Column="0" Text="{Binding ProjectInfo.Description}" TextTrimming="CharacterEllipsis" VerticalAlignment="Center" Margin="0,0,0,5"/>
            </Grid>
        </DataTemplate>

        <!--For ProjectPageList Data template for "File Number" field-->
        <DataTemplate x:Key="ProjectPageFileNumberTemplate">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="AUTO"></ColumnDefinition>
                    <ColumnDefinition Width="*"></ColumnDefinition>
                </Grid.ColumnDefinitions>
                <TextBlock Grid.Column="0" MinWidth="20" Text="{Binding FileNodes.Count}" TextAlignment="Right"></TextBlock>
                <TextBlock Grid.Column="1" Text="{DynamicResource MainWin__ProjectListView_Files}" VerticalAlignment="Center" Margin="10,0,0,0"/>
            </Grid>
        </DataTemplate>

        <!--MenuItem style-->
        <Style x:Key="MLB_MenuItem" TargetType="{x:Type MenuItem}">
            <Setter Property="Foreground" Value="Black" />
            <Setter Property="Background" Value="White" />
            <Setter Property="FontFamily" Value="/nxrmdapp;component/resources/font/#Lato" />
            <Setter Property="Height" Value="25"/>

            <!--<Setter Property="Foreground" Value="{Binding Path=Foreground, RelativeSource={RelativeSource AncestorType={x:Type Menu}}}"/>-->
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type MenuItem}">
                        <Border x:Name="Border"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                >
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition x:Name="Col0" MinWidth="17" Width="Auto" SharedSizeGroup="MenuItemIconColumnGroup" />
                                    <ColumnDefinition Width="Auto"  SharedSizeGroup="MenuTextColumnGroup"/>
                                    <ColumnDefinition Width="Auto"  SharedSizeGroup="MenuItemIGTColumnGroup"/>
                                    <ColumnDefinition x:Name="Col3" Width="14"/>
                                </Grid.ColumnDefinitions>

                                <!-- Content for show an Icon if needed -->
                                <ContentPresenter Grid.Column="0" 
                                                  Margin="4,0,6,0" x:Name="Icon" 
                                                  VerticalAlignment="Center" ContentSource="Icon"/>

                                <!-- Glyph is a checkmark if needed for a checkable menu -->
                                <Grid Grid.Column="0" Visibility="Hidden" Margin="4,0,6,0" x:Name="GlyphPanel" VerticalAlignment="Center">
                                    <Path x:Name="GlyphPanelpath" VerticalAlignment="Center" Fill="{TemplateBinding Foreground}" 
                                          Data="M0,2 L0,4.8 L2.5,7.4 L7.1,2.8 L7.1,0 L2.5,4.6 z" FlowDirection="LeftToRight"/>
                                </Grid>

                                <!-- Content for the menu text -->
                                <ContentPresenter Grid.Column="1"
                                          Margin="{TemplateBinding Padding}"
                                          x:Name="HeaderHost"
                                          RecognizesAccessKey="True"
                                          VerticalAlignment="Center"
                                          ContentSource="Header"/>

                                <!-- Content for the menu IGT(ShortCut key) -->
                                <ContentPresenter Grid.Column="2"
                                          Margin="30,1,5,1"
                                          x:Name="IGTHost"
                                          ContentSource="InputGestureText"                                      
                                          VerticalAlignment="Center"/>

                                <!-- Arrow drawn path which points to the next level of the menu -->
                                <Grid Grid.Column="3" Margin="4,0,6,0" x:Name="ArrowPanel" VerticalAlignment="Center">
                                    <Path x:Name="ArrowPanelPath" HorizontalAlignment="Right" VerticalAlignment="Center" 
                                          Fill="{TemplateBinding Foreground}" Data="M0,0 L0,8 L4,4 z"/>
                                </Grid>

                                <!-- The Popup is the body of the menu which expands 
                                     down or across depending on the level of the item -->
                                <!--<Popup IsOpen="{Binding Path=IsSubmenuOpen, RelativeSource ={RelativeSource TemplatedParent}}" 
                                       Placement="Right" x:Name="SubMenuPopup" Focusable="false" 
                                       PopupAnimation="{DynamicResource {x:Static SystemParameters.MenuPopupAnimationKey}}">
                                    <Border x:Name="SubMenuBorder" BorderBrush="Gray"  Background="White"
                                        BorderThickness="1">
                                        <Grid x:Name="SubMenu" Grid.IsSharedSizeScope="True">
                                            -->
                                <!-- StackPanel holds children of the menu. This is set by IsItemsHost=True -->
                                <!--
                                            <StackPanel IsItemsHost="True" KeyboardNavigation.DirectionalNavigation="Cycle"/>
                                        </Grid>
                                    </Border>
                                </Popup>-->

                                <!--弹出子集菜单容器-->
                                <Popup x:Name="SubMenuPopup" AllowsTransparency="true" IsOpen="{Binding IsSubmenuOpen, RelativeSource={RelativeSource TemplatedParent}}" 
                                        Placement="Bottom"  Focusable="false" VerticalOffset="0"
                                   PopupAnimation="{DynamicResource {x:Static SystemParameters.MenuPopupAnimationKey}}">
                                    <Border Background="{TemplateBinding Background}"  CornerRadius="0" Margin="5" 
                                                BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}"
                                            >
                                        <!--Add Shadow for the Border-->
                                        <Border.Effect>
                                            <DropShadowEffect ShadowDepth="2" BlurRadius="5" Opacity="0.8"/>
                                        </Border.Effect>

                                        <Grid x:Name="SubMenu" Grid.IsSharedSizeScope="True">
                                            <StackPanel Margin="0" IsItemsHost="True" KeyboardNavigation.DirectionalNavigation="Cycle"/>
                                        </Grid>
                                    </Border>
                                </Popup>

                            </Grid>
                        </Border>

                        <!-- These triggers re-configure the four arrangements 
                             of MenuItem to show different levels of menu via Role -->
                        <ControlTemplate.Triggers>
                            <!-- Role = TopLevelHeader : this is the root menu item in a menu; the Popup expands down -->
                            <Trigger Property="Role" Value="TopLevelHeader">
                                <Setter Property="Padding" Value="6,1,6,1"/>
                                <Setter Property="Placement" Value="Bottom" TargetName="SubMenuPopup"/>
                                <Setter Property="MinWidth" Value="0" TargetName="Col0"/>
                                <Setter Property="Width" Value="Auto" TargetName="Col3"/>
                                <!--<Setter Property="CornerRadius" Value="5,5,0,0" TargetName="Border"/>-->
                                <!--<Setter Property="Visibility" Value="Collapsed" TargetName="Icon"/>-->
                                <Setter Property="Visibility" Value="Collapsed" TargetName="GlyphPanel"/>
                                <Setter Property="Visibility" Value="Collapsed" TargetName="IGTHost"/>
                                <Setter Property="Visibility" Value="Collapsed" TargetName="ArrowPanel"/>
                            </Trigger>

                            <!-- Role = TopLevelItem :  this is a child menu item from the top level without any child items-->
                            <Trigger Property="Role" Value="TopLevelItem">
                                <Setter Property="Padding" Value="6,1,6,1"/>
                                <Setter Property="MinWidth" Value="0" TargetName="Col0"/>
                                <Setter Property="Width" Value="Auto" TargetName="Col3"/>
                                <Setter Property="Visibility" Value="Collapsed" TargetName="ArrowPanel"/>
                                <Setter Property="Visibility" Value="Collapsed" TargetName="IGTHost"/>
                                <Setter Property="Visibility" Value="Collapsed" TargetName="GlyphPanel"/>
                            </Trigger>

                            <!-- Role = SubMenuHeader : this is a child menu item which does not have children -->
                            <Trigger Property="Role" Value="SubmenuHeader">
                                <Setter Property="DockPanel.Dock" Value="Top"/>
                                <Setter Property="Placement" Value="Right" TargetName="SubMenuPopup"/>
                                <Setter Property="Padding" Value="0,2,0,2"/>
                            </Trigger>

                            <!-- Role = SubMenuItem : this is a child menu item which has children-->
                            <Trigger Property="Role" Value="SubmenuItem">
                                <Setter Property="DockPanel.Dock" Value="Top"/>
                                <Setter Property="Padding" Value="0,2,0,2"/>
                                <Setter Property="Visibility" Value="Collapsed" TargetName="ArrowPanel"/>
                            </Trigger>

                            <Trigger Property="IsSuspendingPopupAnimation" Value="true">
                                <Setter Property="PopupAnimation" Value="None" TargetName="SubMenuPopup"/>
                            </Trigger>

                            <!-- If no Icon is present the we collapse the Icon Content -->
                            <Trigger Property="Icon" Value="{x:Null}">
                                <Setter Property="Visibility" Value="Collapsed" TargetName="Icon"/>
                            </Trigger>

                            <!-- The GlyphPanel contains the CheckMark -->
                            <Trigger Property="IsChecked" Value="true">
                                <Setter Property="Visibility" Value="Visible" TargetName="GlyphPanel"/>
                                <Setter Property="Visibility" Value="Collapsed" TargetName="Icon"/>
                            </Trigger>

                            <!-- Using the system colors for the Menu Highlight and IsEnabled-->
                            <Trigger Property="IsHighlighted" Value="true">
                                <Setter Property="Background" Value="#0083D7" TargetName="Border"/>
                                <Setter Property="Foreground" Value="White"/>
                            </Trigger>

                            <!--Set text color as LightGray when disable-->
                            <Trigger Property="IsEnabled" Value="false">
                                <Setter Property="Foreground" Value="LightGray"/>
                            </Trigger>

                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!--Separator style for menu-->
        <Style x:Key="MLB_Separator" TargetType="{x:Type Separator}">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type Separator}">
                        <Grid>
                            <Rectangle Height="1" Stroke="Gray" />
                            <!--<Rectangle Height="1" Stroke="{Binding Path=Foreground, RelativeSource={RelativeSource AncestorType={x:Type Menu}}}" />-->
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!--File ListView item style: this can control the align in each column -->
        <Style x:Key="ListviewItemStyle" TargetType="{x:Type ListViewItem}">
            <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>

            <EventSetter Event="MouseDoubleClick" Handler="ListViewItem_DoubleClick"/>
            <EventSetter Event="Selected" Handler="ListViewItem_Selected"/>

            <Style.Triggers>
                <Trigger Property="IsSelected" Value="true">
                    <Setter Property="Background" Value="#C6EEDC"/>
                </Trigger>
                <Trigger Property="IsMouseOver" Value="true">
                    <Setter Property="Background" Value="#E9FFF5"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!--image rotate for refresh-->
        <Style TargetType="{x:Type Button}" x:Key="RefreshRotate">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Grid>
                            <Border Name="Border" BorderBrush="#F5D350" BorderThickness="1" CornerRadius="3" Visibility="Hidden">
                                <Border.Background>
                                    <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                        <GradientStop Color="#FDEEB3" Offset="0"/>
                                        <GradientStop Color="#FDE690" Offset="0.3"/>
                                        <GradientStop Color="#FDEEAE" Offset="0.56"/>
                                        <GradientStop Color="#FFFFFF" Offset="1"/>
                                    </LinearGradientBrush>
                                </Border.Background>
                            </Border>

                            <Ellipse Height="15" Width="15">
                                <Ellipse.Fill>
                                    <ImageBrush  ImageSource="/rmc/resources/icons/Icon_refresh.png"></ImageBrush>
                                </Ellipse.Fill>
                            </Ellipse>
                        </Grid>
                        <ControlTemplate.Triggers>

                            <Trigger Property="IsMouseOver" Value="true">
                                <Setter TargetName="Border" Property="Visibility" Value="Visible"></Setter>
                            </Trigger>

                            <Trigger Property="Button.IsPressed" Value="true">
                                <Setter TargetName="Border" Property="Visibility" Value="Visible"></Setter>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Setter Property="HorizontalAlignment" Value="Center"></Setter>
            <Setter Property="RenderTransformOrigin" Value="0.5,0.5"></Setter>
            <Setter Property="RenderTransform">
                <Setter.Value>
                    <RotateTransform></RotateTransform>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <EventTrigger RoutedEvent="Button.Click">
                    <EventTrigger.Actions>
                        <BeginStoryboard>
                            <Storyboard>
                                <DoubleAnimation Storyboard.TargetProperty="RenderTransform.Angle" From="0" To="360" Duration="0:0:0.8" ></DoubleAnimation>
                            </Storyboard>
                        </BeginStoryboard>
                    </EventTrigger.Actions>
                </EventTrigger>
                <!--<EventTrigger RoutedEvent="Button.MouseLeave">
                    <EventTrigger.Actions>
                        <BeginStoryboard>
                            <Storyboard>
                                <DoubleAnimation Storyboard.TargetProperty="RenderTransform.Angle" Duration="0:0:0.2"></DoubleAnimation>
                            </Storyboard>
                        </BeginStoryboard>
                    </EventTrigger.Actions>
                </EventTrigger>-->
            </Style.Triggers>
        </Style>

        <!--Upload button-->
        <Style TargetType="Button" x:Key="MouseOverBtnStyleExUpload">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate>
                        <Grid>
                            <!-- Border style-->
                            <Border Name="Border" BorderBrush="#F9E080" BorderThickness="1" CornerRadius="3" Visibility="Hidden">
                                <Border.Background>
                                    <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                        <GradientStop Color="#FDEEB3" Offset="0"/>
                                        <GradientStop Color="#FDE690" Offset="0.3"/>
                                        <GradientStop Color="#FDEEAE" Offset="0.56"/>
                                        <GradientStop Color="#FFFFFF" Offset="1"/>
                                    </LinearGradientBrush>
                                </Border.Background>
                            </Border>

                            <!--Content-->
                            <StackPanel Orientation="Horizontal">
                                <Image Source="{Binding IsStartUpload, Converter={StaticResource btnUploadTagConver} }" Stretch="None" Margin="5,0,0,0"/>
                                <TextBlock x:Name="Tb_ProtectFile" Text="{Binding IsStartUpload,Converter={StaticResource btnUploadContentConver}}"  Margin="5,0,5,0" VerticalAlignment="Center"/>
                            </StackPanel>

                        </Grid>

                        <!--Triggers-->
                        <ControlTemplate.Triggers>

                            <Trigger Property="IsMouseOver" Value="true">
                                <Setter TargetName="Border" Property="Visibility" Value="Visible"></Setter>
                            </Trigger>

                            <Trigger Property="Button.IsPressed" Value="true">
                                <Setter TargetName="Border" Property="Visibility" Value="Visible"></Setter>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>

                </Setter.Value>
            </Setter>
        </Style>

        <!--ProgressBar style-->
        <SolidColorBrush x:Key="ProgressBar.Progress" Color="#FF06B025"/>
        <SolidColorBrush x:Key="ProgressBar.Background" Color="#FFE6E6E6"/>
        <SolidColorBrush x:Key="ProgressBar.Border" Color="#FFBCBCBC"/>
        <Style x:Key="ProgressBarStyle1" TargetType="{x:Type ProgressBar}">
            <Setter Property="Foreground" Value="{StaticResource ProgressBar.Progress}"/>
            <Setter Property="Background" Value="{StaticResource ProgressBar.Background}"/>
            <Setter Property="BorderBrush" Value="{StaticResource ProgressBar.Border}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type ProgressBar}">
                        <Grid x:Name="TemplateRoot">
                            <VisualStateManager.VisualStateGroups>
                                <VisualStateGroup x:Name="CommonStates">
                                    <VisualState x:Name="Determinate"/>
                                    <VisualState x:Name="Indeterminate">
                                        <Storyboard RepeatBehavior="Forever">
                                            <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.RenderTransform).(TransformGroup.Children)[0].(ScaleTransform.ScaleX)" Storyboard.TargetName="Animation">
                                                <EasingDoubleKeyFrame KeyTime="0" Value="0.25"/>
                                                <EasingDoubleKeyFrame KeyTime="0:0:1" Value="0.25"/>
                                                <EasingDoubleKeyFrame KeyTime="0:0:2" Value="0.25"/>
                                            </DoubleAnimationUsingKeyFrames>
                                            <PointAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.RenderTransformOrigin)" Storyboard.TargetName="Animation">
                                                <EasingPointKeyFrame KeyTime="0" Value="-0.5,0.5"/>
                                                <EasingPointKeyFrame KeyTime="0:0:1" Value="0.5,0.5"/>
                                                <EasingPointKeyFrame KeyTime="0:0:2" Value="1.5,0.5"/>
                                            </PointAnimationUsingKeyFrames>
                                        </Storyboard>
                                    </VisualState>
                                </VisualStateGroup>
                            </VisualStateManager.VisualStateGroups>
                            <Border CornerRadius="4" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" Background="{TemplateBinding Background}"/>
                            <Border CornerRadius="4" x:Name="PART_Track"/>
                            <Grid x:Name="PART_Indicator" ClipToBounds="true" HorizontalAlignment="Left">
                                <Border CornerRadius="4" x:Name="Indicator" Background="{TemplateBinding Foreground}"/>
                                <Border CornerRadius="4" x:Name="Animation" Background="{TemplateBinding Foreground}" RenderTransformOrigin="0.5,0.5">
                                    <Border.RenderTransform>
                                        <TransformGroup>
                                            <ScaleTransform/>
                                            <SkewTransform/>
                                            <RotateTransform/>
                                            <TranslateTransform/>
                                        </TransformGroup>
                                    </Border.RenderTransform>
                                </Border>
                            </Grid>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="Orientation" Value="Vertical">
                                <Setter Property="LayoutTransform" TargetName="TemplateRoot">
                                    <Setter.Value>
                                        <RotateTransform Angle="-90"/>
                                    </Setter.Value>
                                </Setter>
                            </Trigger>
                            <Trigger Property="IsIndeterminate" Value="true">
                                <Setter Property="Visibility" TargetName="Indicator" Value="Collapsed"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <!-- Binding the input gusture for menu command-->
    <Window.InputBindings>

        <!--File Menu-->
        <KeyBinding Gesture="Ctrl+O" Command="{Binding MenuCommand}" CommandParameter="Open File"/>
        <KeyBinding Gesture="Ctrl+Shift+A" Command="{Binding MenuCommand}" CommandParameter="Add File"/>
        <KeyBinding Gesture="Ctrl+Shift+P" Command="{Binding MenuCommand}" CommandParameter="Protect File"/>
        <KeyBinding Gesture="Ctrl+Shift+S" Command="{Binding MenuCommand}" CommandParameter="Share File"/>
        <!--<KeyBinding Gesture="Del" Command="{Binding MenuCommand}" CommandParameter="Remove File"/>-->
        <KeyBinding Gesture="Ctrl+Shift+I" Command="{Binding MenuCommand}" CommandParameter="View File Info"/>
        <KeyBinding Gesture="Ctrl+Shift+W" Command="{Binding MenuCommand}" CommandParameter="Signout"/>
        <KeyBinding Gesture="Ctrl+Shift+Q" Command="{Binding MenuCommand}" CommandParameter="Exit"/>

        <!--View Menu-->
        <KeyBinding Gesture="Left" Command="{Binding MenuCommand}" CommandParameter="Previous"/>
        <KeyBinding Gesture="Right" Command="{Binding MenuCommand}" CommandParameter="Next"/>
        <KeyBinding Gesture="F5" Command="{Binding MenuCommand}" CommandParameter="Refresh Screen"/>

        <!--Help Menu-->
        <KeyBinding Gesture="F1" Command="{Binding MenuCommand}" CommandParameter="Help"/>


    </Window.InputBindings>

    <Border  Margin="0,0,0,5" Background="White">

        <!--root grid-->
        <Grid>
            <!--Control the column ratio-->
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="53*"/>
                <ColumnDefinition Width="929*"/>
            </Grid.ColumnDefinitions>

            <Grid.RowDefinitions>
                <!--Menu bar-->
                <RowDefinition Height="auto"/>
                <!--tool bar-->
                <RowDefinition Height="45"/>
                <!--Working area-->
                <RowDefinition Height="*"/>
                <!--Status bar-->
                <RowDefinition Height="40"/>
            </Grid.RowDefinitions>

            <!--Menu bar-->
            <StackPanel Orientation="Vertical" Grid.Row="0" Grid.ColumnSpan="2">
                <Grid Margin="10,0,10,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="300"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="250"/>
                    </Grid.ColumnDefinitions>

                    <!--menu items-->
                    <Menu Name="windowMenu" Grid.Column="0" VerticalAlignment="Top" Background="White"  >

                        <!--File-->
                        <MenuItem Header="{DynamicResource MainWin__windowMenu_Header_File}" Style="{StaticResource MLB_MenuItem}">

                            <MenuItem Header="{DynamicResource MainWin__windowMenu_Header_Protect_File}" Style="{StaticResource MLB_MenuItem}" 
                                  InputGestureText="Ctrl+Shift+P" 
                                  IsEnabled="{Binding IsInitializing,Converter={StaticResource ConverseBoolConverter}}"
                                  Command="{Binding MenuCommand}"
                                  CommandParameter="Protect File">
                            </MenuItem>

                            <MenuItem Header="{DynamicResource MainWin__windowMenu_Header_Open_File}" Style="{StaticResource MLB_MenuItem}"        
                                  InputGestureText="Ctrl+O" Command="{Binding MenuCommand}" CommandParameter="Open File">
                                <MenuItem.IsEnabled>
                                    <MultiBinding Converter="{StaticResource MenuitemFileStatusNetworkMultiBindConverter}">
                                        <Binding Path="CurrentSelectedFile"/>
                                        <Binding Path="IsNetworkAvailable"/>
                                    </MultiBinding>
                                </MenuItem.IsEnabled>
                            </MenuItem>

                            <MenuItem Header="{DynamicResource MainWin__windowMenu_Header_Add_File}" 
                                      Style="{StaticResource MLB_MenuItem}"        
                                      InputGestureText="Ctrl+Shift+A" 
                                      IsEnabled="{Binding IsInitializing, Converter={StaticResource ConverseBoolConverter}}"
                                      Command="{Binding MenuCommand}" 
                                      CommandParameter="Add File">
                            </MenuItem>

                            <MenuItem Header="{DynamicResource MainWin__windowMenu_Header_Share_File}" Style="{StaticResource MLB_MenuItem}" 
                                  InputGestureText="Ctrl+Shift+S" 
                                  Command="{Binding MenuCommand}" CommandParameter="Share File">
                                <MenuItem.IsEnabled>
                                    <MultiBinding Converter="{StaticResource ShareBtnIsEnableConver}">
                                        <Binding Path="IsInitializing"/>
                                        <Binding Path="CurrentWorkingArea"/>
                                    </MultiBinding>
                                </MenuItem.IsEnabled>
                            </MenuItem>

                            <!--Separator line-->
                            <!--<Separator Style="{StaticResource MLB_Separator}"></Separator>

                            <MenuItem Header="{DynamicResource MainWin__windowMenu_Header_Stop_Upload}" Style="{StaticResource MLB_MenuItem}"  
                                  IsEnabled="{Binding IsStartUpload,Converter={StaticResource MenuitemStopUploadConver}}"
                                  Command="{Binding MenuCommand}" CommandParameter="Stop Upload"></MenuItem>

                            <MenuItem Header="{DynamicResource MainWin__windowMenu_Header_Start_Upload}" Style="{StaticResource MLB_MenuItem}"
                                  IsEnabled="{Binding IsStartUpload,Converter={StaticResource MenuitemStartUploadConver}}"
                                  Command="{Binding MenuCommand}" CommandParameter="Start Upload"></MenuItem>-->

                            <!--Separator line-->
                            <Separator Style="{StaticResource MLB_Separator}"></Separator>

                            <MenuItem  Name="Menu_ViewFileInfo" Header="{DynamicResource MainWin__windowMenu_Header_View_File_Info}" Style="{StaticResource MLB_MenuItem}" InputGestureText="Ctrl+Shift+I"
                                   Command="{Binding MenuCommand}" CommandParameter="View File Info">
                                <MenuItem.IsEnabled>
                                    <MultiBinding Converter="{StaticResource MenuItemFileInfoIsEnableCovert}">
                                        <Binding Path="CurrentSelectedFile"/>
                                        <Binding Path="IsNetworkAvailable"/>
                                    </MultiBinding>
                                </MenuItem.IsEnabled>
                            </MenuItem>

                            <!--Separator line-->
                            <Separator Style="{StaticResource MLB_Separator}"></Separator>

                            <MenuItem Name="Menu_logout" Header="{DynamicResource MainWin__windowMenu_Header_Log_out}" Style="{StaticResource MLB_MenuItem}" InputGestureText="Ctrl+Shift+W" 
                                   Command="{Binding MenuCommand}" CommandParameter="Signout"></MenuItem>

                            <!--Separator line-->
                            <Separator Style="{StaticResource MLB_Separator}"></Separator>

                            <MenuItem Name="Menu_exit" Header="{DynamicResource MainWin__windowMenu_Header_Exit}" Style="{StaticResource MLB_MenuItem}" InputGestureText="Ctrl+Shift+Q" 
                                  Command="{Binding MenuCommand}" CommandParameter="Exit"></MenuItem>

                        </MenuItem>

                        <!--Tools-->
                        <MenuItem Header="{DynamicResource MainWin__windowMenu_Header_Tools}" Style="{StaticResource MLB_MenuItem}" >

                            <MenuItem Header="{DynamicResource MainWin__windowMenu_Header_Stop_Upload}" Style="{StaticResource MLB_MenuItem}"  
                                  IsEnabled="{Binding IsStartUpload,Converter={StaticResource MenuitemStopUploadConver}}"
                                  Command="{Binding MenuCommand}" CommandParameter="Stop Upload"></MenuItem>

                            <MenuItem Header="{DynamicResource MainWin__windowMenu_Header_Start_Upload}" Style="{StaticResource MLB_MenuItem}"
                                  IsEnabled="{Binding IsStartUpload,Converter={StaticResource MenuitemStartUploadConver}}"
                                  Command="{Binding MenuCommand}" CommandParameter="Start Upload"></MenuItem>

                            <!--<MenuItem Header="{DynamicResource MainWin__windowMenu_Header_Refresh_Screen}" Style="{StaticResource MLB_MenuItem}" InputGestureText="F5" 
                                  Command="{Binding MenuCommand}" CommandParameter="Refresh Screen"></MenuItem>
                            --><!--Separator line--><!--
                            <Separator Style="{StaticResource MLB_Separator}"></Separator>
                            <MenuItem Header="{DynamicResource MainWin__windowMenu_Header_Sort_By}" Style="{StaticResource MLB_MenuItem}">
                                <MenuItem Header="{DynamicResource MainWin__windowMenu_Header_File_Name}" Style="{StaticResource MLB_MenuItem}"  Command="{Binding MenuCommand}" CommandParameter="File Name"/>
                                <MenuItem Header="{DynamicResource MainWin__windowMenu_Header_Last_Modified}" Style="{StaticResource MLB_MenuItem}"  Command="{Binding MenuCommand}" CommandParameter="Last Modified"/>
                                <MenuItem Header="{DynamicResource MainWin__windowMenu_Header_File_Size}" Style="{StaticResource MLB_MenuItem}"  Command="{Binding MenuCommand}" CommandParameter="File Size"/>
                            </MenuItem>-->

                            <!--Separator line-->
                            <Separator Style="{StaticResource MLB_Separator}"></Separator>

                            <!--Prefrences-->
                            <MenuItem Header="{DynamicResource MainWin__windowMenu_Header_Preferences}" Style="{StaticResource MLB_MenuItem}"  Command="{Binding MenuCommand}" CommandParameter="Preferences"/>
                        </MenuItem>

                        <!--Help-->
                        <MenuItem Header="{DynamicResource MainWin__windowMenu_Header_Help}" Style="{StaticResource MLB_MenuItem}">

                            <!--Now hide this item-->
                            <MenuItem Header="{DynamicResource MainWin__windowMenu_Header_Getting_Started}" Style="{StaticResource MLB_MenuItem}" Visibility="Collapsed"
                                  Command="{Binding MenuCommand}" CommandParameter="Getting Started"></MenuItem>

                            <MenuItem Header="{DynamicResource MainWin__windowMenu_Header_Help2}" Style="{StaticResource MLB_MenuItem}" InputGestureText="F1" 
                                   Command="{Binding MenuCommand}" CommandParameter="Help"></MenuItem>

                            <!--Separator line-->
                            <Separator Style="{StaticResource MLB_Separator}" Visibility="Collapsed"></Separator>

                            <MenuItem Header="{DynamicResource MainWin__windowMenu_Header_Check_for_Updates}" Style="{StaticResource MLB_MenuItem}" 
                                  Command="{Binding MenuCommand}" CommandParameter="Check For Updates" Visibility="Collapsed"></MenuItem>

                            <MenuItem Header="{DynamicResource MainWin__windowMenu_Header_Report_an_issue}" Style="{StaticResource MLB_MenuItem}" Foreground="Red" 
                                   Command="{Binding MenuCommand}" CommandParameter="Report an issue" Visibility="Collapsed"></MenuItem>

                        </MenuItem>
                    </Menu>

                    <!--user status-->
                    <StackPanel Grid.Column="2" Orientation="Horizontal" Margin="0,0,10,0" HorizontalAlignment="Right">

                        <Grid Margin="3" Height="25" Width="25" >
                            <Ellipse Stroke="{Binding AvatarBackground}" Fill="{Binding AvatarBackground}"/>

                            <TextBlock VerticalAlignment="Center" HorizontalAlignment="Center"
                               TextAlignment="Center" Text="{Binding AvatarText}" Foreground="{Binding AvatarTextColor}">
                            </TextBlock>

                        </Grid>

                        <StackPanel Margin="10,0,0,0" VerticalAlignment="Center">
                            <TextBlock x:Name="user_name"  FontSize="11"  Text="{Binding UserName}" ToolTip="{Binding UserName}" TextTrimming="CharacterEllipsis" 
                                   FontWeight="Bold" MaxWidth="150"/>

                            <TextBlock x:Name="login_status" Margin="0,4,0,0" Text="{Binding IsNetworkAvailable, Converter={StaticResource nsb2ls}}" 
                                   FontWeight="Bold"
                                   Foreground="{Binding IsNetworkAvailable, Converter={StaticResource nsb2lc}}" FontSize="9"/>
                        </StackPanel>
                    </StackPanel>

                </Grid>
                <!--Horizontal separator line-->
                <Separator Background="LightGray"/>
            </StackPanel>

            <!--tool bar-->
            <Grid Grid.Row="1" Grid.ColumnSpan="2">

                <!--Set bg gradient-->
                <Grid.Background>
                    <LinearGradientBrush StartPoint="0.5, 0" EndPoint="0.5, 1">
                        <GradientStop Color="White" Offset="0"/>
                        <GradientStop Color="#EFEFEF" Offset="0.95"/>
                    </LinearGradientBrush>
                </Grid.Background>

                <Grid.ColumnDefinitions>
                    <!--protect-->
                    <ColumnDefinition Width="auto"/>
                    <!--share-->
                    <ColumnDefinition Width="auto"/>
                    <!--vertical line-->
                    <ColumnDefinition Width="30"/>
                    <!--view select-->
                    <!--if have combox ,the width is "170"-->
                    <!--<ColumnDefinition Width="170"/>-->
                    <ColumnDefinition Width="40"/>
                    <!--search-->
                    <ColumnDefinition Width="200"/>

                    <ColumnDefinition Width="*"/>
                    <!--upload-->
                    <ColumnDefinition Width="120"/>
                    <!--vertical line-->
                    <ColumnDefinition Width="5"/>
                    <!--more other-->
                    <ColumnDefinition Width="110"/>
                </Grid.ColumnDefinitions>

                <!--protect a file-->
                <Button Grid.Column="0" Margin="10,0,0,0" Height="35"
                        Command="{Binding DelegateCommand }" CommandParameter="Cmd_Protect"
                        Content="{DynamicResource MainWin__Btn_Protect}" 
                        Style="{StaticResource ResourceKey=MouseOverBtnStyleEx}">
                    <Button.IsEnabled>
                        <MultiBinding Converter="{StaticResource ProtectBtnIsEnableConver}">
                            <Binding Path="IsInitializing"/>
                            <Binding Path="CurrentWorkingArea"/>
                        </MultiBinding>
                    </Button.IsEnabled>
                    <Button.Tag>
                        <MultiBinding Converter="{StaticResource ProtectBtnTagConver}">
                            <Binding Path="IsInitializing"/>
                            <Binding Path="CurrentWorkingArea"/>
                        </MultiBinding>
                    </Button.Tag>
                </Button>
                <StackPanel Grid.Column="1" Orientation="Horizontal">
                    <!--protect & share-->
                    <Button Grid.Column="1" Height="35" Visibility="Collapsed"
                        Content="{DynamicResource MainWin__Btn_Share}" 
                        Command="{Binding DelegateCommand}" CommandParameter="Cmd_Share"
                        Style="{StaticResource ResourceKey=MouseOverBtnStyleEx}">
                        <Button.IsEnabled>
                            <MultiBinding Converter="{StaticResource ShareBtnIsEnableConver}">
                                <Binding Path="IsInitializing"/>
                                <Binding Path="CurrentWorkingArea"/>
                            </MultiBinding>
                        </Button.IsEnabled>
                        <Button.Tag>
                            <MultiBinding Converter="{StaticResource ShareBtnTagConver}">
                                <Binding Path="IsInitializing"/>
                                <Binding Path="CurrentWorkingArea"/>
                            </MultiBinding>
                        </Button.Tag>
                    </Button>

                    <!--add nxl file-->
                    <Button Height="35"
                        Content="Add protected file"
                        Command="{Binding DelegateCommand}" CommandParameter="Cmd_AddNxl"
                        Style="{StaticResource ResourceKey=MouseOverBtnStyleEx}">
                        <Button.IsEnabled>
                            <MultiBinding Converter="{StaticResource ProtectBtnIsEnableConver}">
                                <Binding Path="IsInitializing"/>
                                <Binding Path="CurrentWorkingArea"/>
                            </MultiBinding>
                        </Button.IsEnabled>
                        <Button.Tag>
                            <MultiBinding Converter="{StaticResource AddNxlBtnTagConver}">
                                <Binding Path="IsInitializing"/>
                                <Binding Path="CurrentWorkingArea"/>
                            </MultiBinding>
                        </Button.Tag>
                    </Button>
                </StackPanel>

                <!--vertical separator line-->
                <Rectangle Grid.Column="2" Width="0.8" Fill="Gray" Opacity="0.5"/>


                <!--select itme and refresh-->
                <StackPanel Orientation="Horizontal" Grid.Column="3" Margin="0,0,10,0" Visibility="Visible">

                    <ComboBox Width="130" Height="23" Margin="5,0,0,0" SelectedIndex="0" Visibility="Collapsed">

                        <!--Selection Changed event-->
                        <i:Interaction.Triggers>
                            <i:EventTrigger EventName="SelectionChanged">
                                <local_event:MyEventCommand Command="{Binding FilterFilesCommand}" />
                            </i:EventTrigger>
                        </i:Interaction.Triggers>

                        <ComboBoxItem Content="{DynamicResource MainWin__Combox_View_All}"></ComboBoxItem>
                        <!--<ComboBoxItem>Available Offline</ComboBoxItem>-->
                        <ComboBoxItem Content="{DynamicResource MainWin__Combox_Waiting_for_Upload}"></ComboBoxItem>
                        <!--<ComboBoxItem>All Online Files</ComboBoxItem>-->
                        <ComboBoxItem Content="{DynamicResource MainWin__Combox_All_Local_Files}"></ComboBoxItem>

                    </ComboBox>

                    <!--btnRefesh-->
                    <Button x:Name="Refresh" Style="{StaticResource RefreshRotate}" 
                             Command="{Binding DelegateCommand }" CommandParameter="Cmd_Refresh"
                             Margin="10,0,0,0" Height="15" Width="15" ToolTip="Refresh"></Button>

                </StackPanel>

                <!--search-->
                <DockPanel Grid.Column="4" Visibility="{Binding CurrentWorkingArea,Converter={StaticResource SearchComboxVisibilityConver}}">
                    <local_custom:CustomSearchBox x:Name="SearchBox" VerticalAlignment="Center">
                        <!--Command binding for "SearchEvent" event -->
                        <i:Interaction.Triggers>
                            <i:EventTrigger EventName="SearchEvent">
                                <local_event:MyEventCommand Command="{Binding SearchCommand}" />
                            </i:EventTrigger>
                        </i:Interaction.Triggers>
                    </local_custom:CustomSearchBox>

                </DockPanel>

                <!--upload Folder-->
                <Button x:Name="Upload_Folder" Grid.Column="5" Visibility="Collapsed"
                        HorizontalAlignment="Right" Height="35" VerticalAlignment="Center" Margin="0,0,15,0"
                        Tag="/rmc/resources/icons/Update_Folder.png"
                        Command="{Binding DelegateCommand }" CommandParameter="Cmd_UploadFolder"
                        Content="Update Folder"
                        Style="{StaticResource ResourceKey=MouseOverBtnStyleEx}"/>

                <!--upload operate-->
                <Button x:Name="Upload" Grid.Column="6"
                        HorizontalAlignment="Right" Height="35" VerticalAlignment="Center" Margin="0,0,15,0"
                        Command="{Binding DelegateCommand}" CommandParameter="{Binding IsStartUpload,Converter={StaticResource btnUploadCommandConver}}"
                        Style="{StaticResource ResourceKey=MouseOverBtnStyleExUpload}"/>

                <!--vertical separator line-->
                <Rectangle Grid.Column="7" Width="0.8" Opacity="0.5" Fill="Gray" />

                <!--open Skydrm & Preference -->
                <StackPanel Orientation="Horizontal" Grid.Column="8" HorizontalAlignment="Right"  Margin="0,0,15,0">

                    <Button Height="30" 
                            Content="/rmc/resources/icons/open_skydrm.png"
                            Command="{Binding DelegateCommand}" CommandParameter="Cmd_OpenWeb"
                            ToolTip="{DynamicResource Open_Skydrm_Web}"
                            Style="{StaticResource ResourceKey=MouseOverBtnStyle}"/>

                    <Button x:Name="settingBtn" Height="30"
                            Command="{Binding DelegateCommand}" CommandParameter="Cmd_Setting"
                            ToolTip="{DynamicResource MainWin__Btn_Setting}"
                            Content="/rmc/resources/icons/set_menu.png"
                            Style="{StaticResource ResourceKey=MouseOverBtnStyle}">
                        <Button.ContextMenu>
                            <ContextMenu x:Name="settingBtnCtMenu" Placement="MousePoint">
                                <!--Prefrences-->
                                <MenuItem Header="{DynamicResource MainWin__windowMenu_Header_Preferences}" Style="{StaticResource MLB_MenuItem}"  
                                          Command="{Binding DelegateCommand}" CommandParameter="Cmd_Preferences"/>
                                <!--About SkyDRM-->
                                <MenuItem Header="{DynamicResource MainWin__windowMenu_Header_About_Skydrm_Desktop}" Style="{StaticResource MLB_MenuItem}" 
                                   Command="{Binding DelegateCommand}" CommandParameter="Cmd_About"/>
                            </ContextMenu>
                        </Button.ContextMenu>
                    </Button>

                </StackPanel>

            </Grid>

            <!--Horizontal separator line-->
            <Rectangle Grid.Row="1" Grid.ColumnSpan="2" Margin="0,43,0,0" Height="2" Fill="LightGray"/>

            <!--Working area: file list-->
            <Grid Grid.Row="2" Grid.ColumnSpan="2">

                <Grid>

                    <Grid.ColumnDefinitions>
                        <!--The width can not use 'auto', it will have scrollViewer display question in TreeViewComponent-->
                        <!--<ColumnDefinition Width="170" MinWidth="150" MaxWidth="600"/>
                        <ColumnDefinition Width="3"/>-->
                        <ColumnDefinition Width="{Binding IsDisplayTreeview,Converter={StaticResource WidthConver}}" MaxWidth="600"/>
                        <ColumnDefinition Width="3"/>
                        <ColumnDefinition Width="*" MinWidth="600"/>
                    </Grid.ColumnDefinitions>

                    <!--TreeView-->
                    <Grid Grid.Column="0" Visibility="{Binding IsDisplayTreeview,Converter={StaticResource VisibilityConver}}">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="*"></RowDefinition>
                                <RowDefinition Height="10"></RowDefinition>
                                <RowDefinition Height="150"></RowDefinition>
                            </Grid.RowDefinitions>

                            <ScrollViewer x:Name="TreeView_Scroll" Margin="0,0,0,5" HorizontalScrollBarVisibility="Disabled" VerticalScrollBarVisibility="Auto">
                                <Tree_View:TreeViewComponent x:Name="UserControl_TreeView" Grid.Row="0" TransmitItemEvent="TreeViewItem_Selected"></Tree_View:TreeViewComponent>
                            </ScrollViewer>

                            <!--Filters-->
                            <DockPanel Grid.Row="1" Height="10"  HorizontalAlignment="Stretch" >
                                <Grid HorizontalAlignment="Stretch">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"></ColumnDefinition>
                                        <ColumnDefinition Width="40"></ColumnDefinition>
                                        <ColumnDefinition Width="*"></ColumnDefinition>
                                    </Grid.ColumnDefinitions>
                                    <Line Grid.Column="0" HorizontalAlignment="Left" Margin="0,5,2,2" X1="0" Y1="0" X2="500" Y2="0" Stroke="#BDBDBD" StrokeThickness="8"/>
                                    <TextBlock Grid.Column="1" VerticalAlignment="Center" LineHeight="10" Foreground="#BDBDBD">FILTERS</TextBlock>
                                    <Line Grid.Column="2" HorizontalAlignment="Right" Margin="2,5,0,2" X1="0" Y1="0" X2="500" Y2="0" Stroke="#BDBDBD" StrokeThickness="8"/>
                                </Grid>

                            </DockPanel>

                            <!--Offlien and OutBox-->
                            <StackPanel Grid.Row="2" Margin="0,0,0,0">
                                <Button x:Name="BtnOffline" Margin="0,15,0,0"  VerticalAlignment="Center"
                                           Height="30" HorizontalContentAlignment="Left"
                                           FontSize="11.88"
                                           Command="{Binding DelegateCommand }" CommandParameter="Cmd_OfflineFiles"
                                           Style="{StaticResource ResourceKey = FilterBtnStyle}">
                                    <StackPanel Orientation="Horizontal">
                                        <Image Stretch="None" Margin="15,0,0,0" Source="/rmc/resources/icons/Offline.png" />
                                        <TextBlock Margin="5,0,0,0" VerticalAlignment="Center" Text="{DynamicResource MainWin__Btn_AllOfflineFile}"></TextBlock>
                                    </StackPanel>
                                </Button>

                                <Button x:Name="BtnOutbox" Margin="0,0,0,0"  VerticalAlignment="Center"
                                           HorizontalContentAlignment="Left" Height="30"
                                           FontSize="11.88"
                                           Command="{Binding DelegateCommand }" CommandParameter="Cmd_OutBox"
                                           Style="{StaticResource ResourceKey = FilterBtnStyle}">
                                    <StackPanel Orientation="Horizontal">
                                        <Image Stretch="None" Margin="15,0,0,0" Source="/rmc/resources/icons/Outbox.png" />
                                        <TextBlock Margin="5,0,0,0" VerticalAlignment="Center" Text="{DynamicResource MainWin__Btn_OutBox}"></TextBlock>
                                    </StackPanel>
                                </Button>

                                <Button Visibility="Collapsed" x:Name="BtnShareWith" Margin="0,15,0,0"
                                            HorizontalContentAlignment="Left"
                                            Height="30" Background="Transparent" 
                                            BorderBrush="Transparent" BorderThickness="0"
                                            FontSize="11.88"
                                            Command="{Binding DelegateCommand }" CommandParameter="Cmd_ShareWithMe">
                                    <StackPanel Orientation="Horizontal">
                                        <Image Stretch="None" Margin="15,0,0,0" Source="/rmc/resources/icons/ShareWithMe.png" />
                                        <TextBlock Margin="5,0,0,0" VerticalAlignment="Center" Text="{DynamicResource MainWin__TreeView_ShareWithMe}"></TextBlock>
                                    </StackPanel>
                                </Button>

                                <!--<Button x:Name="BtnOffline" Margin="0,15,0,0"
                                            HorizontalContentAlignment="Left"
                                            Height="30" Background="Transparent" 
                                            BorderBrush="Transparent" BorderThickness="0"
                                            FontSize="11.88"
                                            Command="{Binding DelegateCommand }" CommandParameter="Cmd_OfflineFiles">
                                    <StackPanel Orientation="Horizontal">
                                        <Image Stretch="None" Margin="15,0,0,0" Source="/rmc/resources/icons/Offline.png" />
                                        <TextBlock Margin="5,0,0,0" VerticalAlignment="Center" Text="{DynamicResource MainWin__Btn_AllOfflineFile}"></TextBlock>
                                    </StackPanel>
                                </Button>

                                <Button x:Name="BtnOutbox" Margin="0,0,0,0"  VerticalAlignment="Center"
                                           HorizontalContentAlignment="Left"
                                            Height="30" Background="Transparent" 
                                            BorderBrush="Transparent" BorderThickness="0"
                                            FontSize="11.88"
                                            Command="{Binding DelegateCommand }" CommandParameter="Cmd_OutBox">
                                    <StackPanel Orientation="Horizontal">
                                        <Image Stretch="None" Margin="15,0,0,0" Source="/rmc/resources/icons/Outbox.png" />
                                        <TextBlock Margin="5,0,0,0" VerticalAlignment="Center" Text="{DynamicResource MainWin__Btn_OutBox}"></TextBlock>
                                    </StackPanel>
                                </Button>-->
                            </StackPanel>

                        </Grid>

                    </Grid>


                    <GridSplitter Grid.Column="1"  HorizontalAlignment="Stretch" Opacity="0.5" Visibility="{Binding IsDisplayTreeview,Converter={StaticResource VisibilityConver}}"></GridSplitter>

                    <!--ListView-->
                    <Grid Grid.Column="2">
                        <DockPanel LastChildFill="True">
                            <StackPanel DockPanel.Dock="Top" Orientation="Vertical" Height="40" Background="#399749" Visibility="{ Binding IsNetworkAvailable, Converter={StaticResource NeteWork2VisibilityConver}}">
                                <TextBlock Margin="0,2,0,0" TextAlignment="Center" FontSize="15" Foreground="White" FontWeight="Bold" Text="{DynamicResource MainWin_Network_PromptTitle}"></TextBlock>
                                <TextBlock TextAlignment="Center" FontSize="12" Foreground="White" Text="{DynamicResource MainWin_Network_PromptTitle2}"></TextBlock>
                            </StackPanel>

                            <Grid DockPanel.Dock="Top">
                                <Grid.Visibility>
                                    <MultiBinding Converter="{StaticResource RepoInfoVisibleConvert}">
                                        <Binding Path="CurrentWorkingArea" />
                                        <Binding Path="IsInitializing" />
                                    </MultiBinding>
                                </Grid.Visibility>
                                <Grid.Background>
                                    <LinearGradientBrush StartPoint="0.5, 0" EndPoint="0.5, 1">
                                        <GradientStop Color="White" Offset="0"/>
                                        <GradientStop Color="#EFEFEF" Offset="0.95"/>
                                    </LinearGradientBrush>
                                </Grid.Background>

                                <Grid.ColumnDefinitions>
                                    <!--image-->
                                    <ColumnDefinition Width="auto"/>
                                    <!--repo name and describe-->
                                    <ColumnDefinition Width="1*"/>
                                    <!--combox and refresh-->
                                    <ColumnDefinition Width="auto"/>
                                    <!--vertical separator line-->
                                    <ColumnDefinition Width="30"/>
                                    <!--create folder and upload file-->
                                    <ColumnDefinition Width="auto"/>
                                    <!--vertical separator line-->
                                    <ColumnDefinition Width="30"/>
                                    <!--Project member manager-->
                                    <ColumnDefinition Width="auto"/>
                                </Grid.ColumnDefinitions>
                                <!--repo icon-->
                                <Image Grid.Column="0" Margin="10" Width="20" Height="20" Stretch="Uniform" Source="{Binding CurrentWorkingAreaInfo.Image}"/>
                                <!--repo name and describe-->
                                <StackPanel Grid.Column="1" Orientation="Vertical" VerticalAlignment="Center">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="auto"/>
                                            <ColumnDefinition/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Grid.Column="0" FontSize="14" Foreground="Black" Text="{Binding CurrentWorkingAreaInfo.RepoName}"/>
                                        <StackPanel Grid.Column="1" Orientation="Horizontal" Visibility="{Binding CurrentWorkingAreaInfo.RepoProviderClass, Converter={StaticResource RepoInfoExternalRepoTypeIconVisible}}">
                                            <Ellipse Margin="10,0,0,0" Width="5" Height="5" Fill="#8B8B8B"/>
                                            <Image Margin="10,0,0,0" Width="20" Height="20" Stretch="Uniform" Source="{Binding CurrentWorkingAreaInfo.RepoProviderClass, Converter={StaticResource RepositoriesTypeIconConvert}}"/>
                                        </StackPanel>
                                    </Grid>
                                    <TextBlock FontSize="11" Foreground="#828282" TextTrimming="CharacterEllipsis"
                                               Text="{Binding CurrentWorkingAreaInfo.Describe}" 
                                               Visibility="{Binding CurrentWorkingAreaInfo.Describe,Converter={StaticResource RepoDescribeVisibleConvert}}"/>
                                </StackPanel>
                                <!--combox and refresh-->
                                <StackPanel Grid.Column="2" Orientation="Horizontal" Visibility="Collapsed">
                                    <ComboBox Width="130" Height="23" Margin="5,0,0,0" SelectedIndex="0">
                                        <!--Selection Changed event-->
                                        <i:Interaction.Triggers>
                                            <i:EventTrigger EventName="SelectionChanged">
                                                <local_event:MyEventCommand Command="{Binding FilterFilesCommand}" />
                                            </i:EventTrigger>
                                        </i:Interaction.Triggers>
                                        <ComboBoxItem Content="{DynamicResource MainWin__Combox_View_All}"></ComboBoxItem>
                                        <!--<ComboBoxItem>Available Offline</ComboBoxItem>-->
                                        <ComboBoxItem Content="{DynamicResource MainWin__Combox_Waiting_for_Upload}"></ComboBoxItem>
                                        <!--<ComboBoxItem>All Online Files</ComboBoxItem>-->
                                        <ComboBoxItem Content="{DynamicResource MainWin__Combox_All_Local_Files}"></ComboBoxItem>
                                    </ComboBox>
                                    <!--btnRefesh-->
                                    <Button Margin="10,0,0,0" Height="15" Width="15" 
                                            Command="{Binding DelegateCommand }" 
                                            CommandParameter="Cmd_Refresh"
                                            Style="{StaticResource RefreshRotate}"/>
                                </StackPanel>
                                <!--vertical separator line-->
                                <Rectangle Grid.Column="3" Width="0.8" Opacity="0.5" Stroke="Gray" 
                                           Visibility="{Binding CurrentWorkingArea,Converter={StaticResource UploadFileVisibleConvert}}"/>
                                <!--create folder and upload file-->
                                <StackPanel Grid.Column="4" Margin="0,5,0,5" Orientation="Horizontal">
                                    <Button Height="30" Content="/rmc/resources/icons/icon_createfolder@2x.png" 
                                            Command="{Binding DelegateCommand }" 
                                            CommandParameter="Cmd_CreateFolder"
                                            Visibility="{Binding CurrentWorkingArea,Converter={StaticResource CreateFolderVisibleConvert}}"
                                            Style="{StaticResource ResourceKey=MouseOverBtnStyle}"/>
                                    <Button Height="30" Content="/rmc/resources/icons/icon_uploadfile@2x.png"
                                            Command="{Binding DelegateCommand }" 
                                            CommandParameter="Cmd_UploadFile"
                                            Visibility="{Binding CurrentWorkingArea,Converter={StaticResource UploadFileVisibleConvert}}"
                                            ToolTip="{DynamicResource MainWin__Btn_UploadFile}"
                                            Style="{StaticResource ResourceKey=MouseOverBtnStyle}"/>
                                </StackPanel>
                                <!--vertical separator line-->
                                <Rectangle Grid.Column="5" Width="0.8" Opacity="0.5"  Stroke="Gray" 
                                           Visibility="{Binding CurrentWorkingArea,Converter={StaticResource ProjectMemberVisibleConvert}}"/>
                                <!--Project member manager-->
                                <StackPanel Grid.Column="6" Margin="0,5,5,5" Orientation="Horizontal" 
                                            Visibility="{Binding CurrentWorkingArea,Converter={StaticResource ProjectMemberVisibleConvert}}">
                                    <Button Height="30" Content="/rmc/resources/icons/icon_addmember@2x.png" 
                                            Command="{Binding DelegateCommand }" 
                                            CommandParameter="Cmd_AddMember" 
                                            Style="{StaticResource ResourceKey=MouseOverBtnStyle}"/>
                                    <Button Height="30" Content="/rmc/resources/icons/icon_setmember@2x.png"
                                            Command="{Binding DelegateCommand }" 
                                            CommandParameter="Cmd_SetMember" 
                                            Style="{StaticResource ResourceKey=MouseOverBtnStyle}"/>
                                </StackPanel>
                            </Grid>

                            <Grid DockPanel.Dock="Top">
                                <TabControl Name="TabCtl" BorderThickness="0" SelectionChanged="TabControl_SelectionChanged">
                                    <!--All files tab-->
                                    <TabItem Height="35" FontSize="14" Tag="AllFiles"
                                             Header="{DynamicResource MainWin__Tab_All}"
                                             Style="{StaticResource TabItemStyle}">
                                        <Grid>
                                            <!--List.View GridViewColumn-->
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="400"/>
                                                    <ColumnDefinition Width="100"/>
                                                    <ColumnDefinition Width="150"/>
                                                    <ColumnDefinition Width="100"/>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="auto" MinWidth="100"/>
                                                    <!--fix bug 49872 Avoid moving the selectitem left and right-->
                                                    <ColumnDefinition Width="10"/>
                                                </Grid.ColumnDefinitions>

                                                <Grid Grid.Column="0" x:Name="col_name"/>
                                                <Grid Grid.Column="1" x:Name="col_fileLocation"/>
                                                <Grid Grid.Column="2" x:Name="col_dateModified"/>
                                                <Grid Grid.Column="3" x:Name="col_size"/>
                                                <Grid Grid.Column="4" x:Name="col_sharedWith"/>
                                                <Grid Grid.Column="5" x:Name="col_sharedBy"/>
                                            </Grid>

                                            <ListView x:Name="fileList" FontSize="12" BorderThickness="0" 
                                                      SelectionMode="Single" ScrollViewer.HorizontalScrollBarVisibility="Hidden" 
                                                      Visibility="{Binding CurrentWorkingArea,Converter={StaticResource ListViewVisibilityConver}}"
                                                      ItemsSource="{Binding NxlFileList}" ItemContainerStyle="{DynamicResource ListviewItemStyle}"
                                                      ext:ListViewBehavior.HeaderSort="True" 
                                                      list_view:ListViewLayoutManager.Enabled="True">
                                                <ListView.View >
                                                    <GridView>
                                                        <!--Note: Binding and SortField must be "NxlFile.Name" instead of "Name"-->
                                                        <GridViewColumn Width="{Binding ElementName=col_name, Path=ActualWidth}"
                                                                        CellTemplate="{StaticResource nameTemplateEx}"
                                                                        ext:ListViewBehavior.SortField="Name"
                                                                        list_view:RangeColumn.MinWidth="150">
                                                            <GridViewColumnHeader x:Name="ColumnHeader_Name" HorizontalContentAlignment="Left" 
                                                                                  Height="25" Padding="8,0,0,0"
                                                                                  Content="{DynamicResource MainWin__ListView_Name}"/>
                                                        </GridViewColumn>

                                                        <GridViewColumn Width="{Binding ElementName=col_fileLocation, Path=ActualWidth}"
                                                                        DisplayMemberBinding="{Binding Path=Location, Converter={StaticResource FileLocationConentConverter}}"
                                                                        ext:ListViewBehavior.SortField="Location"
                                                                        list_view:RangeColumn.MinWidth="70"
                                                                        list_view:RangeColumn.MaxWidth="150">
                                                            <GridViewColumnHeader x:Name="ColumnHeader_Location" HorizontalContentAlignment="Left"
                                                                                  Padding="8,0,0,0"
                                                                                  Content="{DynamicResource MainWin__ListView_Location}"/>
                                                        </GridViewColumn>

                                                        <GridViewColumn Width="{Binding ElementName=col_dateModified, Path=ActualWidth}"
                                                                        DisplayMemberBinding="{Binding Path=DateModified, Converter={StaticResource TimestampToDateTime}}"
                                                                        ext:ListViewBehavior.SortField="DateModified"
                                                                        list_view:RangeColumn.MinWidth="100"
                                                                        list_view:RangeColumn.MaxWidth="200">
                                                            <GridViewColumnHeader x:Name="ColumnHeader_DateModified" HorizontalContentAlignment="Left"
                                                                                  Padding="8,0,0,0"
                                                                                  Content="{Binding CurrentWorkingArea, Converter={StaticResource IsDisplayDateColConver}}"/>
                                                        </GridViewColumn>

                                                        <!--Note: Binding and SortField must be "NxlFile.Size" instead of "Size"-->
                                                        <GridViewColumn Width="{Binding ElementName=col_size, Path=ActualWidth}"
                                                                        DisplayMemberBinding="{Binding Path=Size, Converter={StaticResource rfsc}}"
                                                                        ext:ListViewBehavior.SortField="Size"
                                                                        list_view:RangeColumn.MinWidth="70"
                                                                        list_view:RangeColumn.MaxWidth="150">
                                                            <GridViewColumnHeader x:Name="ColumnHeader_Size" HorizontalContentAlignment="Left" 
                                                                                  Padding="8,0,0,0" 
                                                                                  Content="{DynamicResource MainWin__ListView_Size}"/>
                                                        </GridViewColumn>

                                                        <GridViewColumn Width="{Binding ElementName=col_sharedWith, Path=ActualWidth}"
                                                                        CellTemplate="{StaticResource sharedWithOrByTemplate}"
                                                                        ext:ListViewBehavior.SortField="SharedWith"
                                                                        list_view:RangeColumn.MinWidth="150">
                                                            <GridViewColumnHeader x:Name="ColumnHeader_SharedWith" HorizontalContentAlignment="Left" 
                                                                                  Padding="8,0,0,0" 
                                                                                  Content="{Binding CurrentWorkingArea, Converter={StaticResource IsDisplayShareColConver}}"/>
                                                        </GridViewColumn>
                                                    </GridView>
                                                </ListView.View>
                                            </ListView>

                                            <!--Filter_ListView (Outbox and Offline)-->
                                            <ListView x:Name="Filter_fileList" FontSize="12" BorderThickness="0" 
                                                      SelectionMode="Single" ScrollViewer.HorizontalScrollBarVisibility="Hidden"
                                                      Visibility="{Binding CurrentWorkingArea,Converter={StaticResource FilterListVisibilityConver}}"
                                                      ItemsSource="{Binding NxlFileList}" 
                                                      ItemContainerStyle="{DynamicResource ListviewItemStyle}"
                                                      ext:ListViewBehavior.HeaderSort="True"
                                                      list_view:ListViewLayoutManager.Enabled="True">
                                                <ListView.View >
                                                    <GridView>
                                                        <!--Note: Binding and SortField must be "NxlFile.Name" instead of "Name"-->
                                                        <GridViewColumn Width="{Binding ElementName=col_name, Path=ActualWidth}"
                                                                        CellTemplate="{StaticResource FilternameTemplateEx}"
                                                                        ext:ListViewBehavior.SortField="Name"
                                                                        list_view:RangeColumn.MinWidth="150">
                                                            <GridViewColumnHeader x:Name="Filter_ColumnHeader_Name" HorizontalContentAlignment="Left"
                                                                                  Height="25" Padding="8,0,0,0"
                                                                                  Content="{DynamicResource MainWin__ListView_Name}"/>
                                                        </GridViewColumn>

                                                        <GridViewColumn Width="{Binding ElementName=col_fileLocation, Path=ActualWidth}"
                                                                        DisplayMemberBinding="{Binding Path=Location, Converter={StaticResource FileLocationConentConverter}}"
                                                                        ext:ListViewBehavior.SortField="Location"
                                                                        list_view:RangeColumn.MinWidth="70"
                                                                        list_view:RangeColumn.MaxWidth="150">
                                                            <GridViewColumnHeader x:Name="Filter_ColumnHeader_Location" HorizontalContentAlignment="Left" 
                                                                                  Padding="8,0,0,0" 
                                                                                  Content="{DynamicResource MainWin__ListView_Location}"/>
                                                        </GridViewColumn>

                                                        <GridViewColumn Width="{Binding ElementName=col_dateModified, Path=ActualWidth}"
                                                                        DisplayMemberBinding="{Binding Path=DateModified, Converter={StaticResource TimestampToDateTime}}"
                                                                        ext:ListViewBehavior.SortField="DateModified"
                                                                        list_view:RangeColumn.MinWidth="100"
                                                                        list_view:RangeColumn.MaxWidth="200">
                                                            <GridViewColumnHeader x:Name="Filter_ColumnHeader_DateModified" HorizontalContentAlignment="Left" 
                                                                                  Padding="8,0,0,0" 
                                                                                  Content="{DynamicResource MainWin__ListView_Date_modified}"/>
                                                        </GridViewColumn>

                                                        <!--Note: Binding and SortField must be "NxlFile.Size" instead of "Size"-->
                                                        <GridViewColumn Width="{Binding ElementName=col_size, Path=ActualWidth}"
                                                                        DisplayMemberBinding="{Binding Path=Size, Converter={StaticResource rfsc}}"
                                                                        ext:ListViewBehavior.SortField="Size"
                                                                        list_view:RangeColumn.MinWidth="70"
                                                                        list_view:RangeColumn.MaxWidth="150">
                                                            <GridViewColumnHeader x:Name="Filter_ColumnHeader_Size" HorizontalContentAlignment="Left" 
                                                                                  Padding="8,0,0,0" 
                                                                                  Content="{DynamicResource MainWin__ListView_Size}"/>
                                                        </GridViewColumn>

                                                        <GridViewColumn Width="{Binding ElementName=col_sharedWith, Path=ActualWidth}"
                                                                        CellTemplate="{StaticResource sharedWithTemplate}"
                                                                        ext:ListViewBehavior.SortField="SharedWith"
                                                                        list_view:RangeColumn.MinWidth="150">
                                                            <GridViewColumnHeader x:Name="Filter_ColumnHeader_SharedWith" HorizontalContentAlignment="Left" 
                                                                                  Padding="8,0,0,0"
                                                                                  Content="{Binding CurrentWorkingArea, Converter={StaticResource IsDisplayShareColConver}}"/>
                                                        </GridViewColumn>

                                                        <GridViewColumn Width="{Binding ElementName=col_sharedBy, Path=ActualWidth}"
                                                                        CellTemplate="{StaticResource sharedByTemplate}"
                                                                        ext:ListViewBehavior.SortField="SharedBy"
                                                                        list_view:RangeColumn.MinWidth="100">
                                                            <GridViewColumnHeader x:Name="Filter_ColumnHeader_SharedBy" HorizontalContentAlignment="Left" 
                                                                                  Padding="8,0,0,0" 
                                                                                  Content="{DynamicResource MainWin__ListView_SharedBy}"/>
                                                        </GridViewColumn>
                                                    </GridView>
                                                </ListView.View>
                                            </ListView>

                                            <!--No items match serch-->
                                            <TextBlock Margin="0,30,0,0" FontSize="12" TextAlignment="Center" Foreground="Gray" 
                                                       Text="{DynamicResource MainWin__Search_Text}">
                                                <TextBlock.Visibility>
                                                    <MultiBinding Converter="{StaticResource SearchPromptVisibilityConver}">
                                                        <Binding Path="IsSearch" />
                                                        <Binding Path="NxlFileList.Count" />
                                                    </MultiBinding>
                                                </TextBlock.Visibility>
                                            </TextBlock>

                                            <!--The Layout when not data-->
                                            <Grid x:Name="ContentLayout_NotData" >
                                                <Grid.Visibility>
                                                    <MultiBinding Converter="{StaticResource ContentNotDataConver}">
                                                        <Binding Path="CurrentWorkingArea" />
                                                        <Binding Path="NxlFileList.Count" />
                                                        <Binding Path="CopyFileList.Count" />
                                                    </MultiBinding>
                                                </Grid.Visibility>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="40"/>
                                                    <RowDefinition Height="*"/>
                                                </Grid.RowDefinitions>

                                                <TextBlock Grid.Row="0" Text="This folder is empty" Foreground="Gray" Margin="20, 20,0,0" Visibility="Collapsed"/>

                                                <StackPanel Orientation="Horizontal" Grid.Row="1" HorizontalAlignment="Center" VerticalAlignment="Center">
                                                    <!--Protect file-->
                                                    <StackPanel Width="320" Height="300" Background="#F0F1F4" >
                                                        <Grid>
                                                            <Grid.RowDefinitions>
                                                                <RowDefinition/>
                                                                <RowDefinition Height="70"/>
                                                                <RowDefinition/>
                                                            </Grid.RowDefinitions>

                                                            <Image Grid.Row="0" Width="120" Height="150"
                                                                   Source="/rmc/resources/icons/home_protect_file_0.5x.png"/>
                                                            <TextBlock Grid.Row="0" Height="20"  Width="200" Padding="70,0,0,0" FontSize="14"
                                                                       Background="White" Opacity="0.8"
                                                                       Text="{DynamicResource MainWin__Text_Title_Protect}"/>

                                                            <TextBlock Grid.Row="1" Margin="20,10,20,0" FontSize="13" HorizontalAlignment="Center"
                                                                       Foreground="Gray" TextWrapping="Wrap" TextAlignment="Center">
                                                                <Run Text="{DynamicResource MainWin__Text_Prompt_Protect}"/>
                                                                <Run Foreground="#0079D8" Text="{DynamicResource MainWin__Text_Prompt_MyVault_Protect}"/>
                                                            </TextBlock>

                                                            <Button Grid.Row="2" Margin="0,20,0,0" Height="35" Padding="0,0,0,20" FontSize="13"
                                                                    Content="{DynamicResource MainWin__Text_Btn_Protect}"
                                                                    Command="{Binding DelegateCommand }" 
                                                                    CommandParameter="Cmd_Protect"
                                                                    Style="{StaticResource UnifiedBtnStyle_Positive}"/>
                                                        </Grid>
                                                    </StackPanel>

                                                    <!--Share file-->
                                                    <StackPanel Width="320" Height="300" Background="#F0F1F4" Margin="10,0,0,0">
                                                        <Grid>
                                                            <Grid.RowDefinitions>
                                                                <RowDefinition/>
                                                                <RowDefinition Height="70"/>
                                                                <RowDefinition/>
                                                            </Grid.RowDefinitions>

                                                            <Image Grid.Row="0" Height="150"
                                                                   Source="/rmc/resources/icons/home_share_file.png"/>
                                                            <TextBlock Grid.Row="0" Height="20" Width="200"  Padding="45,0,0,0" FontSize="14"
                                                                       Background="White" Opacity="0.8"
                                                                       Text="{DynamicResource MainWin__Text_Title_Share}"/>

                                                            <TextBlock Grid.Row="1" Margin="20,10,20,0" FontSize="13" HorizontalAlignment="Center"
                                                                       Foreground="Gray" TextWrapping="Wrap" TextAlignment="Center" >
                                                                <Run Text="{DynamicResource MainWin__Text_Prompt_Share}"/>
                                                            </TextBlock>

                                                            <Button Grid.Row="2" Margin="0,20,0,0" Padding="0,0,0,20"  Height="35" FontSize="13"
                                                                    Content="{DynamicResource MainWin__Text_Btn_Share}"
                                                                    Command="{Binding DelegateCommand}" 
                                                                    CommandParameter="Cmd_Share"
                                                                    Style="{StaticResource UnifiedBtnStyle_Positive}" />
                                                        </Grid>
                                                    </StackPanel>
                                                </StackPanel>

                                            </Grid>

                                        </Grid>
                                    </TabItem>
                                    <!--Shared with this project-->
                                    <TabItem Height="35" FontSize="14" Tag="SharedWith"
                                             Header="{Binding CurrentWorkingArea,Converter={StaticResource TabItemSharedWithHeaderConver}}" 
                                             Visibility="{Binding CurrentWorkingArea,Converter={StaticResource TabItemSharedWithVisibilityConver}}" 
                                             Style="{StaticResource TabItemStyle}">
                                        <Grid>
                                            <!--List.View GridViewColumn-->
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="400"/>
                                                    <ColumnDefinition Width="100"/>
                                                    <ColumnDefinition Width="150"/>
                                                    <ColumnDefinition Width="100"/>
                                                    <ColumnDefinition MinWidth="150"/>
                                                    <ColumnDefinition Width="*"/>
                                                    <!--fix bug 49872 Avoid moving the selectitem left and right-->
                                                    <ColumnDefinition Width="10"/>
                                                </Grid.ColumnDefinitions>

                                                <Grid Grid.Column="0" x:Name="fileSWL_col_name"/>
                                                <Grid Grid.Column="1" x:Name="fileSWL_col_fileLocation"/>
                                                <Grid Grid.Column="2" x:Name="fileSWL_col_dateModified"/>
                                                <Grid Grid.Column="3" x:Name="fileSWL_col_size"/>
                                                <Grid Grid.Column="4" x:Name="fileSWL_col_sharedBy"/>
                                                <Grid Grid.Column="5" x:Name="fileSWL_col_sharedFrom"/>
                                            </Grid>

                                            <ListView x:Name="fileSharedWithList" FontSize="12" BorderThickness="0" 
                                                      SelectionMode="Single" ScrollViewer.HorizontalScrollBarVisibility="Hidden" 
                                                      Visibility="{Binding CurrentWorkingArea,Converter={StaticResource ListViewVisibilityConver}}"
                                                      ItemsSource="{Binding NxlFileList}" ItemContainerStyle="{DynamicResource ListviewItemStyle}"
                                                      ext:ListViewBehavior.HeaderSort="True" 
                                                      list_view:ListViewLayoutManager.Enabled="True">
                                                <ListView.View >
                                                    <GridView>
                                                        <!--Note: Binding and SortField must be "NxlFile.Name" instead of "Name"-->
                                                        <GridViewColumn Width="{Binding ElementName=fileSWL_col_name, Path=ActualWidth}"
                                                                        CellTemplate="{StaticResource nameTemplateEx}"
                                                                        ext:ListViewBehavior.SortField="Name"
                                                                        list_view:RangeColumn.MinWidth="150">
                                                            <GridViewColumnHeader x:Name="fileSWL_colHeader_Name" HorizontalContentAlignment="Left" 
                                                                                  Height="25" Padding="8,0,0,0"
                                                                                  Content="{DynamicResource MainWin__ListView_Name}"/>
                                                        </GridViewColumn>

                                                        <GridViewColumn Width="{Binding ElementName=fileSWL_col_fileLocation, Path=ActualWidth}"
                                                                        DisplayMemberBinding="{Binding Path=Location, Converter={StaticResource FileLocationConentConverter}}"
                                                                        ext:ListViewBehavior.SortField="Location"
                                                                        list_view:RangeColumn.MinWidth="70"
                                                                        list_view:RangeColumn.MaxWidth="150">
                                                            <GridViewColumnHeader x:Name="fileSWL_colHeader_Location" HorizontalContentAlignment="Left"
                                                                                  Padding="8,0,0,0"
                                                                                  Content="{DynamicResource MainWin__ListView_Location}"/>
                                                        </GridViewColumn>

                                                        <GridViewColumn Width="{Binding ElementName=fileSWL_col_dateModified, Path=ActualWidth}"
                                                                        DisplayMemberBinding="{Binding Path=DateModified, Converter={StaticResource TimestampToDateTime}}"
                                                                        ext:ListViewBehavior.SortField="DateModified"
                                                                        list_view:RangeColumn.MinWidth="100"
                                                                        list_view:RangeColumn.MaxWidth="200">
                                                            <GridViewColumnHeader x:Name="fileSWL_colHeader_DateModified" HorizontalContentAlignment="Left"
                                                                                  Padding="8,0,0,0"
                                                                                  Content="{DynamicResource MainWin__ListView_SharedOn}"/>
                                                        </GridViewColumn>

                                                        <!--Note: Binding and SortField must be "NxlFile.Size" instead of "Size"-->
                                                        <GridViewColumn Width="{Binding ElementName=fileSWL_col_size, Path=ActualWidth}"
                                                                        DisplayMemberBinding="{Binding Path=Size, Converter={StaticResource rfsc}}"
                                                                        ext:ListViewBehavior.SortField="Size"
                                                                        list_view:RangeColumn.MinWidth="70"
                                                                        list_view:RangeColumn.MaxWidth="150">
                                                            <GridViewColumnHeader x:Name="fileSWL_colHeader_Size" HorizontalContentAlignment="Left" 
                                                                                  Padding="8,0,0,0" 
                                                                                  Content="{DynamicResource MainWin__ListView_Size}"/>
                                                        </GridViewColumn>

                                                        <GridViewColumn Width="{Binding ElementName=fileSWL_col_sharedBy, Path=ActualWidth}"
                                                                        CellTemplate="{StaticResource sharedByTemplate}"
                                                                        ext:ListViewBehavior.SortField="SharedBy"
                                                                        list_view:RangeColumn.MinWidth="150">
                                                            <GridViewColumnHeader x:Name="fileSWL_colHeader_SharedBy" HorizontalContentAlignment="Left" 
                                                                                  Padding="8,0,0,0" 
                                                                                  Content="{DynamicResource MainWin__ListView_SharedBy}"/>
                                                        </GridViewColumn>

                                                        <GridViewColumn Width="{Binding ElementName=fileSWL_col_sharedFrom, Path=ActualWidth}"
                                                                        DisplayMemberBinding="{Binding SharedByProject}"
                                                                        ext:ListViewBehavior.SortField="SharedFrom"
                                                                        list_view:RangeColumn.MinWidth="150">
                                                            <GridViewColumnHeader x:Name="fileSWL_colHeader_SharedFrom" HorizontalContentAlignment="Left" 
                                                                                  Padding="8,0,0,0" 
                                                                                  Content="{Binding CurrentWorkingArea, Converter={StaticResource IsDisplaySharedFromColConver}}"/>
                                                        </GridViewColumn>
                                                    </GridView>
                                                </ListView.View>
                                            </ListView>

                                            <!--No items match serch-->
                                            <TextBlock Margin="0,30,0,0" FontSize="12" TextAlignment="Center" Foreground="Gray" 
                                                       Text="{DynamicResource MainWin__Search_Text}">
                                                <TextBlock.Visibility>
                                                    <MultiBinding Converter="{StaticResource SearchPromptVisibilityConver}">
                                                        <Binding Path="IsSearch" />
                                                        <Binding Path="NxlFileList.Count" />
                                                    </MultiBinding>
                                                </TextBlock.Visibility>
                                            </TextBlock>

                                        </Grid>
                                    </TabItem>
                                    <!--Shared from this project-->
                                    <!--Shared by-->
                                    <TabItem Height="35" FontSize="14" Tag="SharedFrom"
                                             Header="{Binding CurrentWorkingArea,Converter={StaticResource TabItemSharedByHeaderConver}}" 
                                             Visibility="{Binding CurrentWorkingArea,Converter={StaticResource TabItemSharedByVisibilityConver}}"
                                             Style="{StaticResource TabItemStyle}">
                                        <Grid>
                                            <!--List.View GridViewColumn-->
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="400"/>
                                                    <ColumnDefinition Width="100"/>
                                                    <ColumnDefinition Width="150"/>
                                                    <ColumnDefinition Width="100"/>
                                                    <ColumnDefinition Width="*"/>
                                                    <!--fix bug 49872 Avoid moving the selectitem left and right-->
                                                    <ColumnDefinition Width="10"/>
                                                </Grid.ColumnDefinitions>

                                                <Grid Grid.Column="0" x:Name="fileSBL_col_name"/>
                                                <Grid Grid.Column="1" x:Name="fileSBL_col_fileLocation"/>
                                                <Grid Grid.Column="2" x:Name="fileSBL_col_dateModified"/>
                                                <Grid Grid.Column="3" x:Name="fileSBL_col_size"/>
                                                <Grid Grid.Column="4" x:Name="fileSBL_col_sharedWith"/>
                                            </Grid>

                                            <ListView x:Name="fileSharedByList" FontSize="12" BorderThickness="0" 
                                                      SelectionMode="Single" ScrollViewer.HorizontalScrollBarVisibility="Hidden" 
                                                      Visibility="{Binding CurrentWorkingArea,Converter={StaticResource ListViewVisibilityConver}}"
                                                      ItemsSource="{Binding NxlFileList}" ItemContainerStyle="{DynamicResource ListviewItemStyle}"
                                                      ext:ListViewBehavior.HeaderSort="True" 
                                                      list_view:ListViewLayoutManager.Enabled="True">
                                                <ListView.View >
                                                    <GridView>
                                                        <!--Note: Binding and SortField must be "NxlFile.Name" instead of "Name"-->
                                                        <GridViewColumn Width="{Binding ElementName=fileSBL_col_name, Path=ActualWidth}"
                                                                        CellTemplate="{StaticResource SharedByListNameTemplateEx}"
                                                                        ext:ListViewBehavior.SortField="Name"
                                                                        list_view:RangeColumn.MinWidth="150">
                                                            <GridViewColumnHeader x:Name="fileSBL_colHeader_Name" HorizontalContentAlignment="Left" 
                                                                                  Height="25" Padding="8,0,0,0"
                                                                                  Content="{DynamicResource MainWin__ListView_Name}"/>
                                                        </GridViewColumn>

                                                        <GridViewColumn Width="{Binding ElementName=fileSBL_col_fileLocation, Path=ActualWidth}"
                                                                        DisplayMemberBinding="{Binding Path=Location, Converter={StaticResource FileLocationConentConverter}}"
                                                                        ext:ListViewBehavior.SortField="Location"
                                                                        list_view:RangeColumn.MinWidth="70"
                                                                        list_view:RangeColumn.MaxWidth="150">
                                                            <GridViewColumnHeader x:Name="fileSBL_colHeader_Location" HorizontalContentAlignment="Left"
                                                                                  Padding="8,0,0,0"
                                                                                  Content="{DynamicResource MainWin__ListView_Location}"/>
                                                        </GridViewColumn>

                                                        <GridViewColumn Width="{Binding ElementName=fileSBL_col_dateModified, Path=ActualWidth}"
                                                                        DisplayMemberBinding="{Binding Path=DateModified, Converter={StaticResource TimestampToDateTime}}"
                                                                        ext:ListViewBehavior.SortField="DateModified"
                                                                        list_view:RangeColumn.MinWidth="100"
                                                                        list_view:RangeColumn.MaxWidth="200">
                                                            <GridViewColumnHeader x:Name="fileSBL_colHeader_DateModified" HorizontalContentAlignment="Left"
                                                                                  Padding="8,0,0,0"
                                                                                  Content="{Binding CurrentWorkingArea, Converter={StaticResource IsDisplayDateColConver}}"/>
                                                        </GridViewColumn>

                                                        <!--Note: Binding and SortField must be "NxlFile.Size" instead of "Size"-->
                                                        <GridViewColumn Width="{Binding ElementName=fileSBL_col_size, Path=ActualWidth}"
                                                                        DisplayMemberBinding="{Binding Path=Size, Converter={StaticResource rfsc}}"
                                                                        ext:ListViewBehavior.SortField="Size"
                                                                        list_view:RangeColumn.MinWidth="70"
                                                                        list_view:RangeColumn.MaxWidth="150">
                                                            <GridViewColumnHeader x:Name="fileSBL_colHeader_Size" HorizontalContentAlignment="Left" 
                                                                                  Padding="8,0,0,0" 
                                                                                  Content="{DynamicResource MainWin__ListView_Size}"/>
                                                        </GridViewColumn>

                                                        <GridViewColumn Width="{Binding ElementName=fileSBL_col_sharedWith, Path=ActualWidth}"
                                                                        CellTemplate="{StaticResource sharedWithOrByTemplate}"
                                                                        ext:ListViewBehavior.SortField="SharedWith"
                                                                        list_view:RangeColumn.MinWidth="150">
                                                            <GridViewColumnHeader x:Name="fileSBL_colHeader_SharedWith" HorizontalContentAlignment="Left" 
                                                                                  Padding="8,0,0,0" 
                                                                                  Content="{Binding CurrentWorkingArea, Converter={StaticResource IsDisplayShareColConver}}"/>
                                                        </GridViewColumn>
                                                    </GridView>
                                                </ListView.View>
                                            </ListView>

                                            <!--No items match serch-->
                                            <TextBlock Margin="0,30,0,0" FontSize="12" TextAlignment="Center" Foreground="Gray" 
                                                       Text="{DynamicResource MainWin__Search_Text}">
                                                <TextBlock.Visibility>
                                                    <MultiBinding Converter="{StaticResource SearchPromptVisibilityConver}">
                                                        <Binding Path="IsSearch" />
                                                        <Binding Path="NxlFileList.Count" />
                                                    </MultiBinding>
                                                </TextBlock.Visibility>
                                            </TextBlock>

                                        </Grid>
                                    </TabItem>
                                </TabControl>

                                <!--Home UI-->
                                <ScrollViewer Background="White" HorizontalScrollBarVisibility="Disabled" VerticalScrollBarVisibility="Auto"
                                              Visibility="{Binding CurrentWorkingArea,Converter={StaticResource HomeVisibleConvert}}">
                                    <Grid Margin="20">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="auto"/>
                                            <RowDefinition />
                                        </Grid.RowDefinitions>

                                        <StackPanel Grid.Row="0" Orientation="Vertical">
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock VerticalAlignment="Center" FontSize="18" Foreground="#828282" Text="{DynamicResource MainWin__HomeUI_Welcome}"/>
                                                <TextBlock VerticalAlignment="Center" Margin="5,0,0,0" MaxWidth="400" FontSize="18" FontWeight="DemiBold" TextTrimming="CharacterEllipsis"
                                                           Text="{Binding UserName}"/>
                                                <Grid Margin="5,0,0,0" Height="30" Width="30" >
                                                    <Ellipse Stroke="{Binding AvatarBackground}" Fill="{Binding AvatarBackground}"/>

                                                    <TextBlock VerticalAlignment="Center" HorizontalAlignment="Center" TextAlignment="Center"
                                                               Text="{Binding AvatarText}" Foreground="{Binding AvatarTextColor}"/>
                                                </Grid>
                                            </StackPanel>
                                            <Grid Margin="0,20,0,0">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="auto"/>
                                                    <ColumnDefinition Width="auto"/>
                                                </Grid.ColumnDefinitions>

                                                <Border Grid.Column="0" Width="350" BorderBrush="LightGray" BorderThickness="1" CornerRadius="5">
                                                    <Grid>
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="40"/>
                                                            <ColumnDefinition Width="2*"/>
                                                            <ColumnDefinition Width="*"/>
                                                        </Grid.ColumnDefinitions>

                                                        <Border Grid.Column="0" Margin="15,30,15,0" VerticalAlignment="Top" Height="10" Width="10" Background="#249FF4" CornerRadius="2"/>
                                                        <!--<Rectangle Margin="20,30,20,0" VerticalAlignment="Top" Height="10" Width="10" Fill="#249FF4"/>-->
                                                        <StackPanel Grid.Column="1" Margin="0,20,0,20"  Orientation="Vertical">
                                                            <TextBlock FontSize="24" FontWeight="DemiBold"  Text="{DynamicResource MainWin__TreeView_MySpace}"/>
                                                            <TextBlock Margin="0,5,0,0" VerticalAlignment="Center">
                                                                <Run FontSize="20" FontWeight="DemiBold" Text="{Binding MySpaceFileCount}"/>
                                                                <Run FontSize="20" Foreground="#6E6E6E" Text="{DynamicResource MainWin__MySpaceUI_Files}"/>
                                                            </TextBlock>

                                                            <Button Margin="0,10,0,0" FontSize="13" Foreground="#2F80ED" Cursor="Hand"
                                                                    VerticalAlignment="Center"
                                                                     Content="{DynamicResource MainWin__MySpaceUI_ViewFile}"
                                                                    Command="{Binding DelegateCommand }" CommandParameter="Cmd_MySpaceNavigate"
                                                                    Style="{StaticResource ResourceKey=UnifiedBtnStyle_TextBlock}"/>
                                                        </StackPanel>

                                                        <Image Grid.Column="2" Stretch="Uniform" Width="50" Height="70" Source="/rmc/resources/icons/icon_myspace.png"/>
                                                    </Grid>
                                                </Border>

                                                <Border Grid.Column="1" Margin="20,0,0,0" Width="350" BorderBrush="LightGray" BorderThickness="1" CornerRadius="5"
                                                        Visibility="{Binding IsSaasRouter, Converter={StaticResource HomeWorkSpaceVisibleConvert}}">
                                                    <Grid>
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="40"/>
                                                            <ColumnDefinition Width="2*"/>
                                                            <ColumnDefinition Width="*"/>
                                                        </Grid.ColumnDefinitions>

                                                        <Border Grid.Column="0" Margin="15,30,15,0" VerticalAlignment="Top" Height="10" Width="10" Background="#F7D25A" CornerRadius="2"/>
                                                        <!--<Rectangle Margin="20,30,20,0" VerticalAlignment="Top" Height="10" Width="10" Fill="#249FF4"/>-->
                                                        <StackPanel Grid.Column="1" Margin="0,20,0,20"  Orientation="Vertical">
                                                            <TextBlock FontSize="24" FontWeight="DemiBold"  Text="{DynamicResource MainWin__TreeView_WorkSpace}"/>
                                                            <TextBlock Margin="0,5,0,0" VerticalAlignment="Center">
                                                                <Run FontSize="20" FontWeight="DemiBold" Text="{Binding WorkSpaceFileCount}"/>
                                                                <Run FontSize="20" Foreground="#6E6E6E" Text="{DynamicResource MainWin__MySpaceUI_Files}"/>
                                                            </TextBlock>

                                                            <Button Margin="0,10,0,0" FontSize="13" Foreground="#2F80ED" Cursor="Hand"
                                                                    VerticalAlignment="Center"
                                                                    Content="{DynamicResource MainWin__MySpaceUI_ViewFile}"
                                                                    Command="{Binding DelegateCommand }" CommandParameter="Cmd_WorkSpaceNavigate"
                                                                    Style="{StaticResource ResourceKey=UnifiedBtnStyle_TextBlock}"/>
                                                        </StackPanel>

                                                        <Image Grid.Column="2" Stretch="Uniform" Width="70" Height="50" Source="/rmc/resources/icons/icon_workspace.png"/>
                                                    </Grid>
                                                </Border>

                                            </Grid>
                                        </StackPanel>

                                        <Grid Grid.Row="1" Visibility="{Binding ExternalRepos.Count, Converter={StaticResource HomeRepositoryVisibleConvert}}">
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="auto"/>
                                                <RowDefinition/>
                                            </Grid.RowDefinitions>
                                            <TextBlock Grid.Row="0" Margin="0,20,0,0" HorizontalAlignment="Left" FontSize="16" FontWeight="DemiBold"
                                               Text="{DynamicResource MainWin__RepositoryListView_Manage}"/>

                                            <ListView Grid.Row="1" Margin="0,10,0,0" BorderThickness="0" 
                                                      ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                                                      ScrollViewer.VerticalScrollBarVisibility="Disabled"
                                                      ItemsSource="{Binding ExternalRepos}" 
                                                      MouseDoubleClick="ListExternalItem_DoubleClick">
                                                <ListView.ItemsPanel>
                                                    <ItemsPanelTemplate>
                                                        <WrapPanel />
                                                    </ItemsPanelTemplate>
                                                </ListView.ItemsPanel>
                                                <ListView.ItemTemplate>
                                                    <DataTemplate>
                                                        <Border Margin="5" BorderBrush="#FFEAE8E8" BorderThickness="1" CornerRadius="1" >
                                                            <Grid>
                                                                <Grid.ColumnDefinitions>
                                                                    <ColumnDefinition Width="40"/>
                                                                    <ColumnDefinition/>
                                                                    <ColumnDefinition Width="5"/>
                                                                </Grid.ColumnDefinitions>

                                                                <StackPanel Grid.Column="0" Background="#F2F3F5">
                                                                    <Image Margin="5,10,5,10" Width="30" Height="30" Source="{Binding RepoType, Converter={StaticResource RepositoriesIconConvert}}"/>
                                                                </StackPanel>

                                                                <StackPanel Grid.Column="1" Margin="10,0,10,0" Orientation="Vertical" VerticalAlignment="Center">
                                                                    <StackPanel Orientation="Horizontal">
                                                                        <TextBlock FontSize="14" FontWeight="DemiBold" MaxWidth="120" TextTrimming="CharacterEllipsis" Text="{Binding RepoDisplayName}" ToolTip="{Binding RepoDisplayName}"/>
                                                                        <Ellipse Margin="10,0,0,0" Width="5" Height="5" Fill="#8B8B8B"/>
                                                                        <Image Margin="10,0,0,0" Width="20" Height="20" Stretch="Uniform" Source="{Binding RepoProviderClass, Converter={StaticResource RepositoriesTypeIconConvert}}"/>
                                                                    </StackPanel>
                                                                    <TextBlock FontSize="13" Foreground="#706E6E" Text="test@email.com" Visibility="Collapsed"/>
                                                                </StackPanel>
                                                                <Rectangle Grid.Column="2" Fill="{Binding RepoProviderClass, Converter={StaticResource RepositoriesTypeColorConvert}}"/>
                                                            </Grid>
                                                        </Border>
                                                    </DataTemplate>
                                                </ListView.ItemTemplate>
                                            </ListView>
                                        </Grid>
                                    </Grid>
                                </ScrollViewer>

                                <!--MySpace UI-->
                                <ScrollViewer Background="White" HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto"
                                              Visibility="{Binding CurrentWorkingArea,Converter={StaticResource MySpaceVisibleConvert}}">
                                    <Grid Margin="20">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="auto"/>
                                            <RowDefinition Height="auto"/>
                                            <RowDefinition Height="auto"/>
                                        </Grid.RowDefinitions>
                                        <StackPanel Grid.Row="0" Orientation="Vertical">
                                            <StackPanel Orientation="Horizontal">
                                                <Image Stretch="None" Source="/rmc/resources/icons/icon_myspace.png"/>
                                                <TextBlock Margin="10,0,0,0" FontSize="28" FontWeight="Bold" VerticalAlignment="Center" Text="{DynamicResource MainWin__TreeView_MySpace}"/>
                                            </StackPanel>
                                            <TextBlock Margin="0,10,0,0" FontSize="11" TextWrapping="Wrap" Text="{DynamicResource MainWin__MySpaceUI_Describe}"/>
                                            <Rectangle Margin="0,10,0,0" Width="710" Height="1" HorizontalAlignment="Left" Fill="LightGray"/>
                                        </StackPanel>
                                        <StackPanel Grid.Row="1" Orientation="Vertical" HorizontalAlignment="Left">
                                            <TextBlock Margin="0,10,0,0" FontSize="28" FontWeight="Bold" VerticalAlignment="Center" Text="{DynamicResource MainWin__MySpaceUI_Usage}"/>
                                            <TextBlock Margin="0,10,0,0" FontSize="16" Foreground="#989898" VerticalAlignment="Center" Text="{Binding UsageDescribe}"/>

                                            <ProgressBar  Margin="0,10,0,0" HorizontalAlignment="Left" BorderThickness="0" 
                                                          Height="15" Width="710" Value="{Binding MySpacePrgBarValue}" Maximum="{Binding MySpacePrgBarMaximum}" 
                                                          Style="{DynamicResource ProgressBarStyle1}">
                                                <ProgressBar.Foreground>
                                                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                                        <GradientStop Color="#249FF4" Offset="0.0"/>
                                                        <GradientStop Color="#249FF4" Offset="{Binding DrivePrgBarRatio}"/>
                                                        <GradientStop Color="#F7D25A" Offset="{Binding DrivePrgBarRatio}"/>
                                                    </LinearGradientBrush>
                                                </ProgressBar.Foreground>
                                            </ProgressBar>

                                            <Grid Margin="0,20,0,0">
                                                <Grid.RowDefinitions>
                                                    <RowDefinition/>
                                                    <RowDefinition/>
                                                </Grid.RowDefinitions>

                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="auto"/>
                                                    <ColumnDefinition Width="auto"/>
                                                </Grid.ColumnDefinitions>

                                                <Border Grid.Column="0" Width="350" BorderBrush="LightGray" BorderThickness="1" CornerRadius="5">
                                                    <StackPanel Orientation="Horizontal">
                                                        <Border Margin="20,30,20,0" VerticalAlignment="Top" Height="10" Width="10" Background="#249FF4" CornerRadius="2"/>
                                                        <StackPanel Margin="0,20,0,20" Orientation="Vertical">
                                                            <StackPanel Orientation="Horizontal">
                                                                <Image Stretch="None" Source="/rmc/resources/icons/icon_mydrive.png"/>
                                                                <TextBlock Margin="10,0,0,0" FontSize="24" FontWeight="DemiBold"  Text="{DynamicResource MainWin__TreeView_MyDrive}"/>
                                                                <!--<Ellipse Margin="10,0,0,0" Width="5" Height="5" Fill="#DEDDDD"/>
                                                                <TextBlock Margin="10,0,0,0" FontSize="14" Foreground="#989898" VerticalAlignment="Center" Text="{Binding DriveUsage}"/>-->
                                                            </StackPanel>
                                                            <TextBlock Margin="0,10,0,0" MaxWidth="250" FontSize="11" TextWrapping="Wrap" Text="{DynamicResource MainWin__MySpaceUI_MyDriveDescribe}"/>
                                                            <StackPanel Margin="0,10,0,0" Orientation="Horizontal">
                                                                <TextBlock VerticalAlignment="Center">
                                                                    <Run FontSize="20" FontWeight="DemiBold" Text="{Binding DriveFileCount}"/>
                                                                    <Run FontSize="20" Foreground="#6E6E6E" Text="{DynamicResource MainWin__MySpaceUI_Files}"/>
                                                                </TextBlock>
                                                                <Button Margin="10,5,0,0" FontSize="13" Foreground="#2F80ED" Cursor="Hand"
                                                                    VerticalAlignment="Center"
                                                                    Content="{DynamicResource MainWin__MySpaceUI_ViewFile}"
                                                                    Command="{Binding DelegateCommand }" CommandParameter="Cmd_MyDriveNavigate"
                                                                    Style="{StaticResource ResourceKey=UnifiedBtnStyle_TextBlock}"/>
                                                            </StackPanel>
                                                        </StackPanel>
                                                    </StackPanel>
                                                </Border>

                                                <Border Grid.Row="1" Grid.Column="0" Margin="0,10,0,0" Width="350" BorderBrush="LightGray" BorderThickness="1" CornerRadius="5">
                                                    <StackPanel Orientation="Horizontal">
                                                        <Border Margin="20,30,20,0" VerticalAlignment="Top" Height="10" Width="10" Background="Transparent" CornerRadius="2"/>
                                                        <StackPanel Margin="0,20,0,20" Orientation="Vertical">
                                                            <StackPanel Orientation="Horizontal">
                                                                <Image Stretch="None" Source="/rmc/resources/icons/icon_sharewithme.png"/>
                                                                <TextBlock Margin="10,0,0,0" FontSize="24" FontWeight="DemiBold"  Text="{DynamicResource MainWin__TreeView_ShareWithMe}"/>
                                                                <!--<Ellipse Margin="10,0,0,0" Width="5" Height="5" Fill="#DEDDDD"/>
                                                                <TextBlock Margin="10,0,0,0" FontSize="14" Foreground="#989898" VerticalAlignment="Center" Text="{Binding DriveUsage}"/>-->
                                                            </StackPanel>
                                                            <TextBlock Margin="0,10,0,0" MaxWidth="250" FontSize="11" TextWrapping="Wrap" Text="{DynamicResource MainWin__MySpaceUI_ShareWitheMeDescribe}"/>
                                                            <StackPanel Margin="0,10,0,0" Orientation="Horizontal">
                                                                <TextBlock VerticalAlignment="Center">
                                                                    <Run FontSize="20" FontWeight="DemiBold" Text="{Binding SharedWithMeFileCount}"/>
                                                                    <Run FontSize="20" Foreground="#6E6E6E" Text="{DynamicResource MainWin__MySpaceUI_Files}"/>
                                                                </TextBlock>
                                                                <Button Margin="10,5,0,0" FontSize="13" Foreground="#2F80ED" Cursor="Hand"
                                                                    VerticalAlignment="Center"
                                                                    Content="{DynamicResource MainWin__MySpaceUI_ViewFile}"
                                                                    Command="{Binding DelegateCommand }" CommandParameter="Cmd_ShareWithMeNavigate"
                                                                    Style="{StaticResource ResourceKey=UnifiedBtnStyle_TextBlock}"/>
                                                            </StackPanel>
                                                        </StackPanel>
                                                    </StackPanel>
                                                </Border>

                                                <Border Grid.Column="1" Margin="10,0,0,0" Width="350" BorderBrush="LightGray" BorderThickness="1" CornerRadius="5">
                                                    <StackPanel Orientation="Horizontal">
                                                        <Border Margin="20,30,20,0" VerticalAlignment="Top" Height="10" Width="10" Background="#F7D25A" CornerRadius="2"/>
                                                        <StackPanel Margin="0,20,0,20" Orientation="Vertical">
                                                            <StackPanel Orientation="Horizontal">
                                                                <Image Stretch="None" Source="/rmc/resources/icons/icon_myvault.png"/>
                                                                <TextBlock Margin="10,0,0,0" FontSize="24" FontWeight="DemiBold"  Text="{DynamicResource MainWin__TreeView_MyVault}"/>
                                                                <!--<Ellipse Margin="10,0,0,0" Width="5" Height="5" Fill="#DEDDDD"/>
                                                                <TextBlock Margin="10,0,0,0" FontSize="14" Foreground="#989898" VerticalAlignment="Center" Text="{Binding VaultUsage}"/>-->
                                                            </StackPanel>
                                                            <TextBlock Margin="0,10,0,0" MaxWidth="250" FontSize="11" TextWrapping="Wrap" Text="{DynamicResource MainWin__MySpaceUI_MyVaultDescribe}"/>
                                                            <StackPanel Margin="0,10,0,0" Orientation="Horizontal">
                                                                <TextBlock VerticalAlignment="Center">
                                                                    <Run FontSize="20" FontWeight="DemiBold" Text="{Binding VaultFileCount}"/>
                                                                    <Run FontSize="20" Foreground="#6E6E6E" Text="{DynamicResource MainWin__MySpaceUI_Files}"/>
                                                                </TextBlock>
                                                                <Button Margin="10,5,0,0" FontSize="13" Foreground="#2F80ED" Cursor="Hand"
                                                                    VerticalAlignment="Center"
                                                                    Content="{DynamicResource MainWin__MySpaceUI_ViewFile}"
                                                                    Command="{Binding DelegateCommand }" CommandParameter="Cmd_MyVaultNavigate"
                                                                    Style="{StaticResource ResourceKey=UnifiedBtnStyle_TextBlock}"/>
                                                            </StackPanel>
                                                        </StackPanel>
                                                    </StackPanel>
                                                </Border>
                                            </Grid>
                                        </StackPanel>
                                    </Grid>
                                </ScrollViewer>

                                <!--SelectProject UI-->
                                <ListView BorderThickness="0" ScrollViewer.HorizontalScrollBarVisibility="Hidden" 
                                         Visibility="{Binding CurrentWorkingArea,Converter={StaticResource DisplayProjectLixBoxConver}}"
                                         ItemsSource="{Binding CollectionProject}"
                                         MouseDoubleClick="ListProjectItem_DoubleClick"
                                         list_view:ListViewLayoutManager.Enabled="True">
                                    <!--<ListView.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <WrapPanel  Orientation="Horizontal"  Background="Transparent" />
                                        </ItemsPanelTemplate>
                                    </ListView.ItemsPanel>
                                    <ListView.ItemTemplate>
                                        <DataTemplate>
                                            <Border BorderBrush="#FFEAE8E8" BorderThickness="1" CornerRadius="1" Margin="20">
                                                <StackPanel Orientation="Vertical" Background="White"  Width="260" Height="auto" MinHeight="120">
                                                    <Border>
                                                        <Border.Background>
                                                            <LinearGradientBrush StartPoint="0,4" EndPoint="1,-0.5">
                                                                <GradientStop Color="White" Offset="0"/>
                                                                <GradientStop Color="#FFF6FFF8" Offset="0.7"/>
                                                                <GradientStop Color="#FFD6F3DB" Offset="0.9"/>
                                                                <GradientStop Color="#FFD9ECDD" Offset="1"/>
                                                            </LinearGradientBrush>
                                                        </Border.Background>
                                                        <StackPanel>
                                                            <TextBlock Margin="20,10,0,0" TextWrapping="Wrap" FontSize="18" Foreground="#34994C" LineHeight="22" Text="{Binding ProjectInfo.DisplayName}"/>
                                                            <TextBlock Margin="20,5,0,0" Height="40" TextWrapping="Wrap" TextTrimming="CharacterEllipsis" FontSize="13" Foreground="#6E6E6E" LineHeight="11" Text="{Binding ProjectInfo.Description}"/>
                                                        </StackPanel>
                                                    </Border>
                                                    
                                    -->
                                    <!--Separator line-->
                                    <!--
                                    
                                                    <Separator Background="#BDBDBD"></Separator>
                                                    <TextBlock Margin="20,10,0,10" TextWrapping="Wrap" FontSize="14" Foreground="#000000" LineHeight="13" FontWeight="Regular" Text="{Binding FileNodes.Count,  StringFormat={}{0} Files}"/>
                                                </StackPanel>
                                            </Border>

                                        </DataTemplate>
                                    </ListView.ItemTemplate>-->
                                    <ListView.GroupStyle>
                                        <GroupStyle>
                                            <GroupStyle.ContainerStyle>
                                                <Style TargetType="{x:Type GroupItem}">
                                                    <Setter Property="Template">
                                                        <Setter.Value>
                                                            <ControlTemplate TargetType="{x:Type GroupItem}">
                                                                <Expander IsExpanded="True" ExpandDirection="Down" Margin="15,15,0,0">
                                                                    <Expander.Header>
                                                                        <StackPanel Orientation="Horizontal">
                                                                            <TextBlock Foreground="#6E6E6E" FontSize="17" LineHeight="22" Text="{Binding Path=Name, Converter={StaticResource ProjectGroupNameConver}}" VerticalAlignment="Center" />
                                                                            <TextBlock FontWeight="DemiBold" FontSize="17" LineHeight="22" Text="{Binding Path=Name, Converter={StaticResource ProjectGroupName2Conver}}" VerticalAlignment="Center"/>
                                                                            <TextBlock Foreground="#6E6E6E" FontSize="17" LineHeight="22" Text="{Binding Path=ItemCount, StringFormat=({0})}"  VerticalAlignment="Center" Margin="5,0,0,0" />
                                                                        </StackPanel>
                                                                    </Expander.Header>
                                                                    <ItemsPresenter />
                                                                </Expander>
                                                            </ControlTemplate>
                                                        </Setter.Value>
                                                    </Setter>
                                                </Style>
                                            </GroupStyle.ContainerStyle>
                                        </GroupStyle>
                                    </ListView.GroupStyle>

                                    <ListView.View >

                                        <GridView x:Name="ProjectPage_gridView">
                                            <!--Note: Binding and SortField must be "NxlFile.Name" instead of "Name"-->
                                            <GridViewColumn Width="300"
                                                CellTemplate="{StaticResource ProjectPageNameTemplate}"
                                                list_view:RangeColumn.MinWidth="100">
                                                <GridViewColumnHeader x:Name="ProjectPage_ColumnHeader_Name" Content="{DynamicResource MainWin__ListView_Name}" 
                                                Height="25"  HorizontalContentAlignment="Left" Padding="8,0,0,0"/>
                                            </GridViewColumn>

                                            <GridViewColumn Width="300" 
                                                CellTemplate="{StaticResource ProjectPageDescriptionTemplate}"                                                         
                                                list_view:RangeColumn.MinWidth="200">
                                                <GridViewColumnHeader x:Name="ProjectPage_ColumnHeader_ProjectDes" Content="{DynamicResource MainWin__ProjectListView_Description}" 
                                                      HorizontalContentAlignment="Left" Padding="8,0,0,0" />
                                            </GridViewColumn>

                                            <GridViewColumn Width="150"
                                                CellTemplate="{StaticResource ProjectPageFileNumberTemplate}"
                                                list_view:RangeColumn.MinWidth="100"
                                                list_view:RangeColumn.MaxWidth="200">
                                                <GridViewColumnHeader x:Name="ProjectPage_ColumnHeader_DateModified" Content="{DynamicResource MainWin__ProjectListView_FileNumber}" 
                                                      HorizontalContentAlignment="Left" Padding="8,0,0,0" />
                                            </GridViewColumn>

                                        </GridView>
                                    </ListView.View>
                                </ListView>

                                <!--Repositories UI-->
                                <Grid Background="White" Visibility="{Binding CurrentWorkingArea,Converter={StaticResource RepositoriesVisibleConvert}}">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="auto"/>
                                        <RowDefinition Height="1"/>
                                        <RowDefinition/>
                                    </Grid.RowDefinitions>
                                    <TextBlock Grid.Row="0" Margin="20,20,0,20" HorizontalAlignment="Left" FontSize="23" FontWeight="Bold"
                                               Text="{DynamicResource MainWin__RepositoryListView_Manage}"/>
                                    <Button Grid.Row="0" Margin="0,20,20,20" HorizontalAlignment="Right"
                                            FontSize="13" 
                                            Command="{Binding DelegateCommand}" CommandParameter="Cmd_AddRepo"
                                            Content="{DynamicResource MainWin__RepositoryListView_Add}"
                                            Style="{StaticResource UnifiedBtnStyle_Positive}" Visibility="Collapsed"/>

                                    <Rectangle Grid.Row="1" Margin="20,0,20,0" Stroke="#BDBDBD" Fill="#BDBDBD"/>

                                    <StackPanel Grid.Row="2">
                                        <TextBlock Margin="20,10,0,0" HorizontalAlignment="Left" FontSize="16" Foreground="#BDBDBD"
                                               Visibility="{Binding ExternalRepos.Count, Converter={StaticResource RepositoriesConfigTextVisible}}"
                                               Text="{DynamicResource MainWin__RepositoryListView_NoRepo}"/>

                                        <ListView Margin="20,10,20,0" BorderThickness="0" ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                                              ItemsSource="{Binding ExternalRepos}"
                                              MouseDoubleClick="ListExternalItem_DoubleClick">
                                            <ListView.ItemsPanel>
                                                <ItemsPanelTemplate>
                                                    <WrapPanel />
                                                </ItemsPanelTemplate>
                                            </ListView.ItemsPanel>
                                            <ListView.ItemTemplate>
                                                <DataTemplate>
                                                    <Border Margin="5" BorderBrush="#FFEAE8E8" BorderThickness="1" CornerRadius="1" >
                                                        <Grid>
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="40"/>
                                                                <ColumnDefinition/>
                                                                <ColumnDefinition Width="5"/>
                                                            </Grid.ColumnDefinitions>

                                                            <StackPanel Grid.Column="0" Background="#F2F3F5">
                                                                <Image Margin="5,10,5,10" Width="30" Height="30" Source="{Binding RepoType, Converter={StaticResource RepositoriesIconConvert}}"/>
                                                            </StackPanel>

                                                            <StackPanel Grid.Column="1" Margin="10,0,10,0" Orientation="Vertical" VerticalAlignment="Center">
                                                                <StackPanel Orientation="Horizontal">
                                                                    <TextBlock FontSize="14" FontWeight="DemiBold" MaxWidth="120" TextTrimming="CharacterEllipsis" Text="{Binding RepoDisplayName}" ToolTip="{Binding RepoDisplayName}"/>
                                                                    <Ellipse Margin="10,0,0,0" Width="5" Height="5" Fill="#8B8B8B"/>
                                                                    <Image Margin="10,0,0,0" Width="20" Height="20" Stretch="Uniform" Source="{Binding RepoProviderClass, Converter={StaticResource RepositoriesTypeIconConvert}}"/>
                                                                </StackPanel>
                                                                <TextBlock FontSize="13" Foreground="#706E6E" Text="test@email.com" Visibility="Collapsed"/>
                                                            </StackPanel>
                                                            <Rectangle Grid.Column="2" Fill="{Binding RepoProviderClass, Converter={StaticResource RepositoriesTypeColorConvert}}"/>
                                                        </Grid>
                                                    </Border>
                                                </DataTemplate>
                                            </ListView.ItemTemplate>
                                        </ListView>
                                    </StackPanel>

                                </Grid>


                                <!--The loading Page-->
                                <Grid Background="White" Visibility="{Binding IsInitializing, Converter={StaticResource LoadingPageConver}}">
                                    <StackPanel Orientation="Vertical" HorizontalAlignment="Center" VerticalAlignment="Center">
                                        <Image Source="/rmc/resources/icons/BigAppIcon.png" Width="125"></Image>
                                        <local_custom:ProBarComponent2 Margin="0,5,0,5" Width="200"></local_custom:ProBarComponent2>
                                        <TextBlock FontSize="16" LineHeight="17" Text="{DynamicResource MainWin_LoadingPage_Text}"></TextBlock>
                                    </StackPanel>
                                </Grid>

                                <!--Display Empty Folder-->
                                <StackPanel x:Name="emptyFolder" Orientation="Vertical" HorizontalAlignment="Center" VerticalAlignment="Center">
                                    <StackPanel.Visibility>
                                        <MultiBinding Converter="{StaticResource EmptyFolderVisibilityConver}">
                                            <Binding Path="CurrentWorkingArea" />
                                            <Binding Path="IsInitializing" />
                                            <Binding Path="NxlFileList.Count" />
                                            <Binding Path="CopyFileList.Count" />
                                            <Binding Path="CollectionProject.Count"/>
                                        </MultiBinding>
                                    </StackPanel.Visibility>
                                    <Image Stretch="Uniform" Width="100" Height="80" 
                                           Source="/rmc/resources/icons/folder-green-empty.png" 
                                           Visibility="{Binding IsDataLoading,Converter={StaticResource EmptyImageVisibilityConver}}"/>
                                    <TextBlock Margin="0,20,0,0" FontSize="16" LineHeight="17" FontWeight="Medium" Foreground="Gray" 
                                               Text="{Binding IsDataLoading,Converter={StaticResource EmptyFolderTextConver}}"/>
                                </StackPanel>

                            </Grid>

                        </DockPanel>

                    </Grid>

                </Grid>

            </Grid>

            <!--status bar-->
            <Grid Grid.Row="3" Background="#F0F0F0" Grid.ColumnSpan="2">
                <Grid.ColumnDefinitions>
                    <!--item count-->
                    <ColumnDefinition Width="120"/>
                    <!--upload progressbar-->
                    <ColumnDefinition Width="200"/>
                    <ColumnDefinition Width="*"/>
                    <!--upload schedule-->
                    <ColumnDefinition Width="205"/>
                    <!--vertical separator line-->
                    <ColumnDefinition Width="20"/>
                    <!--network status-->
                    <ColumnDefinition Width="160"/>
                </Grid.ColumnDefinitions>

                <!--item count-->
                <StackPanel Grid.Column="0" Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center">
                    <TextBlock Text="{Binding Path=NxlFileList.Count}" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                    <TextBlock Text="{Binding Path=NxlFileList.Count,Converter={StaticResource ItemConver}}" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="5,0,0,0"/>
                </StackPanel>

                <!--upload progressbar-->
                <!--<StackPanel Grid.Column="1" VerticalAlignment="Center" Margin="0,5,0,0">
                    <ProgressBar  Height="6" Value="20"/>
                    <DockPanel >
                        <TextBlock Text="544 MB used" FontSize="10" Foreground="Gray" HorizontalAlignment="Left"/>
                        <TextBlock Text="990 MB free" HorizontalAlignment="Right"/>
                    </DockPanel>
                </StackPanel>-->

                <!--upload schedule-->
                <StackPanel Grid.Column="3" Orientation="Horizontal" VerticalAlignment="Center" HorizontalAlignment="Right">
                    <TextBlock Text="{DynamicResource MainWin__UploadSchedule}" Foreground="Gray"/>
                    <TextBlock Text="{DynamicResource MainWin__UploadSchedule_Auto}" Margin="10,0,0,0"/>
                    <TextBlock Text="{DynamicResource MainWin__UploadSchedule_Change}" Margin="8,0,0,0" Foreground="#70A7F3" Visibility="Collapsed"/>
                </StackPanel>
                <!--vertical separator line-->
                <Rectangle Grid.Column="4" Width="0.8" Height="20"  Stroke="Gray" />

                <!--network status-->
                <StackPanel Grid.Column="5" Orientation="Horizontal" VerticalAlignment="Center">
                    <TextBlock Text="{DynamicResource MainWin__Network_Status}" Foreground="Gray"/>
                    <TextBlock Text="{Binding IsNetworkAvailable, Converter= {StaticResource nsb2s}}" Foreground="Gray" Margin="10,0,0,0"/>
                    <Image Source="{Binding IsNetworkAvailable, Converter={StaticResource nsb2i}}" Stretch="None" Margin="10,0,0,0"/>
                </StackPanel>
            </Grid>


        </Grid>

    </Border>

</local:CustomMainWindow>
